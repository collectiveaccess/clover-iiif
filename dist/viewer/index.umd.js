(function(C,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("react"),require("@iiif/vault"),require("uuid"),require("@radix-ui/react-collapsible"),require("openseadragon"),require("@iiif/vault-helpers"),require("react-error-boundary"),require("@stitches/react"),require("@radix-ui/react-tabs"),require("@radix-ui/react-radio-group"),require("node-webvtt"),require("@radix-ui/react-form"),require("sanitize-html"),require("hls.js"),require("@radix-ui/react-popover"),require("@radix-ui/react-select"),require("@radix-ui/react-switch")):typeof define=="function"&&define.amd?define(["exports","react","@iiif/vault","uuid","@radix-ui/react-collapsible","openseadragon","@iiif/vault-helpers","react-error-boundary","@stitches/react","@radix-ui/react-tabs","@radix-ui/react-radio-group","node-webvtt","@radix-ui/react-form","sanitize-html","hls.js","@radix-ui/react-popover","@radix-ui/react-select","@radix-ui/react-switch"],t):(C=typeof globalThis<"u"?globalThis:C||self,t(C.CloverIIIFViewer={},C.React,C.vault,C.uuid,C.Collapsible,C.OpenSeadragon,C.vaultHelpers,C.reactErrorBoundary,C.react,C.Tabs,C.RadioGroup,C.nodeWebvtt,C.Form$1,C.sanitizeHtml,C.Hls,C.Popover$1,C.Select$1,C.Switch))})(this,function(C,t,de,ne,Tt,re,Mt,ke,Ie,Lt,zt,Ft,Pt,Vt,P,Bt,V,Ot){"use strict";var Ct,kt,It;function G(e){const n=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const r in e)if(r!=="default"){const i=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:()=>e[r]})}}return n.default=e,Object.freeze(n)}const ue=G(Tt),oe=G(Lt),ie=G(zt),X=G(Pt),K=G(Bt),Q=G(V),$e=G(Ot),Ht=e=>{const n=e.toString().split(":"),r=Math.ceil(parseInt(n[0])),i=Math.ceil(parseInt(n[1])),o=Dt(Math.ceil(parseInt(n[2])),2);let l=`${r!==0&&i<10?(i+"").padStart(2,"0"):i}:${o}`;return r!==0&&(l=`${r}:${l}`),l},Ae=e=>{const n=new Date(e*1e3).toISOString().substr(11,8);return Ht(n)},Te=(e,n)=>{if(typeof e!="object"||e===null)return n;for(const r in n)typeof n[r]=="object"&&n[r]!==null&&!Array.isArray(n[r])?(e[r]||(e[r]={}),e[r]=Te(e[r],n[r])):e[r]=n[r];return e},_t=e=>e.split("").reduce(function(n,r){return n=(n<<5)-n+r.charCodeAt(0),n&n},0),Me=(e,n)=>Object.hasOwn(e,n)?e[n].toString():void 0,Dt=(e,n)=>String(e).padStart(n,"0"),N={annotationOverlays:{backgroundColor:"#6666ff",borderColor:"#000099",borderType:"solid",borderWidth:"1px",opacity:"0.5",renderOverlays:!0,zoomLevel:2},background:"transparent",canvasBackgroundColor:"#6662",canvasHeight:"500px",contentSearch:{searchResultsLimit:20,overlays:{backgroundColor:"#ff6666",borderColor:"#990000",borderType:"solid",borderWidth:"1px",opacity:"0.5",renderOverlays:!0,zoomLevel:4}},ignoreCaptionLabels:[],informationPanel:{vtt:{autoScroll:{enabled:!0,settings:{behavior:"smooth",block:"center"}}},open:!0,renderAbout:!0,renderSupplementing:!0,renderToggle:!0,renderAnnotation:!0,renderContentSearch:!0},openSeadragon:{},requestHeaders:{"Content-Type":"application/json"},showDownload:!0,showIIIFBadge:!0,showTitle:!0,withCredentials:!1,localeText:{contentSearch:{tabLabel:"Search Results",formPlaceholder:"Enter search words",noSearchResults:"No search results",loading:"Loading...",moreResults:"more results"}}};function Le(e){let n={...N.informationPanel.vtt.autoScroll};return typeof e=="object"&&(n="enabled"in e?e:{enabled:!0,settings:e}),e===!1&&(n.enabled=!1),Nt(n.settings),n}function Nt({behavior:e,block:n}){const r=["auto","instant","smooth"],i=["center","end","nearest","start"];if(!r.includes(e))throw TypeError(`'${e}' not in ${r.join(" | ")}`);if(!i.includes(n))throw TypeError(`'${n}' not in ${i.join(" | ")}`)}const Wt=Le((kt=(Ct=N==null?void 0:N.informationPanel)==null?void 0:Ct.vtt)==null?void 0:kt.autoScroll),ae={activeCanvas:"",activeManifest:"",OSDImageLoaded:!1,collection:{},configOptions:N,customDisplays:[],plugins:[],isAutoScrollEnabled:Wt.enabled,isAutoScrolling:!1,isInformationOpen:(It=N==null?void 0:N.informationPanel)==null?void 0:It.open,isLoaded:!1,isUserScrolling:void 0,vault:new de.Vault,contentSearchVault:new de.Vault,openSeadragonViewer:null,viewerId:ne.v4()},ze=t.createContext(ae),Fe=t.createContext(ae);function qt(e,n){switch(n.type){case"updateActiveCanvas":return n.canvasId||(n.canvasId=""),{...e,activeCanvas:n.canvasId};case"updateActiveManifest":return{...e,activeManifest:n.manifestId};case"updateOSDImageLoaded":return{...e,OSDImageLoaded:n.OSDImageLoaded};case"updateAutoScrollAnnotationEnabled":return{...e,isAutoScrollEnabled:n.isAutoScrollEnabled};case"updateAutoScrolling":return{...e,isAutoScrolling:n.isAutoScrolling};case"updateCollection":return{...e,collection:n.collection};case"updateConfigOptions":return{...e,configOptions:Te(e.configOptions,n.configOptions)};case"updateInformationOpen":return{...e,isInformationOpen:n.isInformationOpen};case"updateIsLoaded":return{...e,isLoaded:n.isLoaded};case"updateUserScrolling":return{...e,isUserScrolling:n.isUserScrolling};case"updateOpenSeadragonViewer":return{...e,openSeadragonViewer:n.openSeadragonViewer};case"updateViewerId":return{...e,viewerId:n.viewerId};default:throw new Error(`Unhandled action type: ${n.type}`)}}const jt=({initialState:e=ae,children:n})=>{const[r,i]=t.useReducer(qt,e);return t.createElement(ze.Provider,{value:r},t.createElement(Fe.Provider,{value:i},n))};function k(){const e=t.useContext(ze);if(e===void 0)throw new Error("useViewerState must be used within a ViewerProvider");return e}function z(){const e=t.useContext(Fe);if(e===void 0)throw new Error("useViewerDispatch must be used within a ViewerProvider");return e}const Gt=(e,n)=>{const r=e.get({id:n,type:"Canvas"});return!(r!=null&&r.annotations)||!r.annotations[0]?[]:e.get(r.annotations).filter(o=>!o.items||!o.items.length?!1:o).map(o=>{const a=o.label||{none:["Annotations"]};return{...o,label:a}})},Pe=async(e,n,r,i)=>{if(i==null||i.q==null)return{label:{none:[r]}};const o=`${n}?q=${i.q.trim()}&exact=${i.exact}`;let a;try{a=await e.load(o)}catch{return console.log("Could not load content search."),{}}return a.label==null&&(a.label={none:[r]}),a},Ve=(e,n,r,i)=>{var l,c;const o={canvas:void 0,accompanyingCanvas:void 0,annotationPage:void 0,annotations:[]},a=s=>{if(s){if(!s.body||!s.motivation){console.error("Invalid annotation after Hyperion parsing: missing either 'body' or 'motivation'",s);return}let d=s.body;Array.isArray(d)&&(d=d[0]);const h=e.get(d.id);if(!h)return;switch(r){case"painting":return s.target===n.id&&s.motivation&&s.motivation[0]==="painting"&&i.includes(h.type)&&(s.body=h),!!s;case"supplementing":return;default:throw new Error("Invalid annotation motivation.")}}};if(o.canvas=e.get(n),o.canvas&&(o.annotationPage=e.get(o.canvas.items[0]),o.accompanyingCanvas=(l=o.canvas)!=null&&l.accompanyingCanvas?e.get((c=o.canvas)==null?void 0:c.accompanyingCanvas):void 0),o.annotationPage){const s=e.get(o.annotationPage.items).map(h=>({body:e.get(h.body[0].id),motivation:h.motivation,type:"Annotation"})),d=[];s.forEach(h=>{h.body.type==="Choice"?h.body.items.forEach(u=>d.push({...h,id:u.id,body:e.get(u.id)})):d.push(h)}),o.annotations=d.filter(a)}return o},Y=(e,n="en")=>{if(!e)return"";if(!e[n]){const r=Object.getOwnPropertyNames(e);if(r.length>0)return e[r[0]]}return e[n]},le=(e,n)=>{const r=Ve(e,{id:n,type:"Canvas"},"painting",["Image","Sound","Video"]);if(r.annotations.length!==0&&r.annotations&&r.annotations)return r.annotations.map(i=>i==null?void 0:i.body)},Ut=(e,n,r,i)=>{const o=[];if(n.canvas&&n.canvas.thumbnail.length>0){const c=e.get(n.canvas.thumbnail[0]);o.push(c)}if(n.annotations[0]){if(n.annotations[0].thumbnail&&n.annotations[0].thumbnail.length>0){const s=e.get(n.annotations[0].thumbnail[0]);o.push(s)}if(!n.annotations[0].body)return;const c=n.annotations[0].body;c.type==="Image"&&o.push(c)}return o.length===0?void 0:{id:o[0].id,format:o[0].format,type:o[0].type,width:r,height:i}};let U=window.OpenSeadragon;if(!U&&(U=re,!U))throw new Error("OpenSeadragon is missing.");const Be="http://www.w3.org/2000/svg";U.Viewer&&(U.Viewer.prototype.svgOverlay=function(){return this._svgOverlayInfo?this._svgOverlayInfo:(this._svgOverlayInfo=new me(this),this._svgOverlayInfo)});const me=function(e){const n=this;this._viewer=e,this._containerWidth=0,this._containerHeight=0,this._svg=document.createElementNS(Be,"svg"),this._svg.style.position="absolute",this._svg.style.left=0,this._svg.style.top=0,this._svg.style.width="100%",this._svg.style.height="100%",this._viewer.canvas.appendChild(this._svg),this._node=document.createElementNS(Be,"g"),this._svg.appendChild(this._node),this._viewer.addHandler("animation",function(){n.resize()}),this._viewer.addHandler("open",function(){n.resize()}),this._viewer.addHandler("rotate",function(){n.resize()}),this._viewer.addHandler("flip",function(){n.resize()}),this._viewer.addHandler("resize",function(){n.resize()}),this.resize()};me.prototype={node:function(){return this._node},resize:function(){this._containerWidth!==this._viewer.container.clientWidth&&(this._containerWidth=this._viewer.container.clientWidth,this._svg.setAttribute("width",this._containerWidth)),this._containerHeight!==this._viewer.container.clientHeight&&(this._containerHeight=this._viewer.container.clientHeight,this._svg.setAttribute("height",this._containerHeight));const e=this._viewer.viewport.pixelFromPoint(new U.Point(0,0),!0),n=this._viewer.viewport.getZoom(!0),r=this._viewer.viewport.getRotation(),i=this._viewer.viewport.getFlip(),o=this._viewer.viewport._containerInnerSize.x;let a=o*n;const l=a;i&&(a=-a,e.x=-e.x+o),this._node.setAttribute("transform","translate("+e.x+","+e.y+") scale("+a+","+l+") rotate("+r+")")},onClick:function(e,n){new U.MouseTracker({element:e,clickHandler:n}).setTracking(!0)}};const Zt=e=>new me(e),Oe=e=>{var r,i;let n={id:typeof e=="string"?e:e.source};if(typeof e=="string"){if(e.includes("#xywh=")){const o=e.split("#xywh=");if(o&&o[1]){const[a,l,c,s]=o[1].split(",").map(d=>Number(d));n={id:o[0],rect:{x:a,y:l,w:c,h:s}}}}else if(e.includes("#t=")){const o=e.split("#t=");o&&o[1]&&(n={id:o[0],t:o[1]})}}else typeof e=="object"&&(((r=e.selector)==null?void 0:r.type)==="PointSelector"?n={id:e.source,point:{x:e.selector.x,y:e.selector.y}}:((i=e.selector)==null?void 0:i.type)==="SvgSelector"&&(n={id:e.source,svg:e.selector.value}));return n},Xt=e=>fetch(`${e.replace(/\/$/,"")}/info.json`).then(n=>n.json()).then(n=>n).catch(n=>{console.error(`The IIIF tilesource ${e.replace(/\/$/,"")}/info.json failed to load: ${n}`)}),Yt=e=>{let n,r;if(Array.isArray(e)&&(n=e[0],n)){let i;"@id"in n?i=n["@id"]:i=n.id,r=i}return r},pe=e=>{var i;let n,r;if(Rt(e))n=e,r={};else{const o=JSON.parse(Mt.decodeContentState(e));switch(o==null?void 0:o.type){case"SpecificResource":case"Range":case"Annotation":n=o==null?void 0:o.target.partOf[0].id,r={manifest:n,canvas:o==null?void 0:o.target.id};break;case"Canvas":n=o==null?void 0:o.partOf[0].id,r={manifest:n,canvas:o==null?void 0:o.id};break;case"Manifest":n=o==null?void 0:o.id,r={collection:(i=o==null?void 0:o.partOf[0])==null?void 0:i.id,manifest:o==null?void 0:o.id};break;case"Collection":n=o==null?void 0:o.id,r={collection:n};break}}return{resourceId:n,active:r}},Jt=e=>{const{resourceId:n,active:r}=pe(e);return r.collection||r.manifest||n},Kt=(e,n)=>{const r=n.items.map(a=>a.id),{active:i}=pe(e),o=i.canvas;return r.includes(o)?o:r[0]},Qt=(e,n)=>{const{active:r}=pe(e),i=r.manifest,o=n.items.filter(a=>a.type==="Manifest").map(a=>a.id);return o.length==0?null:o.includes(i)?i:o[0]},Rt=e=>{try{new URL(e)}catch{return!1}return!0};var R=(e=>(e.TiledImage="tiledImage",e.SimpleImage="simpleImage",e))(R||{});function He(e,n,r,i,o){if(!e)return;const a=1/n.width;i.forEach(l=>{if(!l.target)return;const c=Oe(l.target),{point:s,rect:d,svg:h}=c;if(d){const{x:u,y,w:g,h:v}=d;tn(e,u*a,y*a,g*a,v*a,r,o)}if(s){const{x:u,y}=s,g=`
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg">
          <circle cx="${u}" cy="${y}" r="20" />
        </svg>
      `;_e(e,g,r,a,o)}h&&_e(e,h,r,a,o)})}function en(e,n,r){let i,o,a=40,l=40;n.rect&&(i=n.rect.x,o=n.rect.y,a=n.rect.w,l=n.rect.h),n.point&&(i=n.point.x,o=n.point.y);const c=1/e.width;return new re.Rect(i*c-a*c/2*(r-1),o*c-l*c/2*(r-1),a*c*r,l*c*r)}function tn(e,n,r,i,o,a,l){const c=new re.Rect(n,r,i,o),s=document.createElement("div");if(a){const{backgroundColor:d,opacity:h,borderType:u,borderColor:y,borderWidth:g}=a;s.style.backgroundColor=d,s.style.opacity=h,s.style.border=`${u} ${g} ${y}`,s.className=l}e.addOverlay(s,c)}function nn(e){if(!e)return null;const n=document.createElement("template");return n.innerHTML=e.trim(),n.content.children[0]}function _e(e,n,r,i,o){const a=nn(n);if(a)for(const l of a.children)De(e,l,r,i,o)}function De(e,n,r,i,o){var a;if(n.nodeName==="#text")on(n);else{const l=rn(n,r,i),c=Zt(e);c.node().append(l),(a=c._svg)==null||a.setAttribute("class",o),n.childNodes.forEach(s=>{De(e,s,r,i,o)})}}function rn(e,n,r){let i=!1,o=!1,a=!1,l=!1;const c=document.createElementNS("http://www.w3.org/2000/svg",e.nodeName);if(e.attributes.length>0)for(let s=0;s<e.attributes.length;s++){const d=e.attributes[s];switch(d.name){case"fill":a=!0;break;case"stroke":i=!0;break;case"stroke-width":o=!0;break;case"fill-opacity":l=!0;break}c.setAttribute(d.name,d.textContent)}return i||(c.style.stroke=n==null?void 0:n.borderColor),o||(c.style.strokeWidth=n==null?void 0:n.borderWidth),a||(c.style.fill=n==null?void 0:n.backgroundColor),l||(c.style.fillOpacity=n==null?void 0:n.opacity),c.setAttribute("transform",`scale(${r})`),c}function on(e){e.textContent&&(e.textContent.includes(`
`)||console.log("nodeName:",e.nodeName,", textContent:",e.textContent,", childNodes.length",e.childNodes.length))}const an=e=>{const n=Array.isArray(e==null?void 0:e.service)&&(e==null?void 0:e.service.length)>0,r=n?Yt(e==null?void 0:e.service):e==null?void 0:e.id,i=n?R.TiledImage:R.SimpleImage;return{uri:r,imageType:i}},ln=(e,n)=>{const r=n?R.TiledImage:R.SimpleImage;return{uri:e,imageType:r}};function Ne(e,n){if(!e)return;n.startsWith(".")||(n="."+n);const r=document.querySelectorAll(n);r&&r.forEach(i=>e.removeOverlay(i))}function fe(e,n,r,i){const o=Oe(r),{point:a,rect:l,svg:c}=o;if(a||l||c){const s=en(i,o,n);e==null||e.viewport.fitBounds(s)}}function sn(e,n,r,i,o){var l;if(!(n!=null&&n.items)||(n==null?void 0:n.items.length)===0)return;const a=[];n.items.forEach(c=>{const s=e.get(c.id);typeof s.target=="string"&&s.target.startsWith(i.id)&&a.push(s)}),r&&((l=o.contentSearch)!=null&&l.overlays)&&He(r,i,o.contentSearch.overlays,a,"content-search-overlay")}const he=209,cn={colors:{primary:"#1a1d1e",primaryMuted:"#26292b",primaryAlt:"#151718",accent:`hsl(${he} 100% 38.2%)`,accentMuted:`hsl(${he} 80% 61.8%)`,accentAlt:`hsl(${he} 80% 30%)`,secondary:"#FFFFFF",secondaryMuted:"#e6e8eb",secondaryAlt:"#c1c8cd"},fontSizes:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},lineHeights:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},sizes:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},space:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},radii:{1:"4px",2:"6px",3:"8px",4:"12px",round:"50%",pill:"9999px"},transitions:{all:"all 300ms cubic-bezier(0.16, 1, 0.3, 1)"},zIndices:{1:"100",2:"200",3:"300",4:"400",max:"999"}},ge={xxs:"(max-width: 349px)",xs:"(max-width: 575px)",sm:"(max-width: 767px)",md:"(max-width: 991px)",lg:"(max-width: 90rem)",xl:"(min-width: calc(90rem + 1px))"},{styled:f,css:fi,keyframes:ve,createTheme:hi}=Ie.createStitches({theme:cn,media:ge}),dn=f("div",{display:"flex",flexDirection:"column",alignItems:"center"}),un=f("p",{fontWeight:"bold",fontSize:"x-large"}),mn=f("span",{fontSize:"medium"}),We=({error:e})=>{const{message:n}=e;return t.createElement(dn,{role:"alert"},t.createElement(un,{"data-testid":"headline"},"Something went wrong"),n&&t.createElement(mn,null,`Error message: ${n}`," "))},qe=f("div",{position:"relative",zIndex:"0"}),je=f("div",{display:"flex",flexDirection:"row",flexGrow:"1",overflow:"hidden","@sm":{flexDirection:"column"}}),Ge=f("div",{display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",width:"61.8%","@sm":{width:"100%"}}),Ue=f(ue.Trigger,{display:"none",border:"none",padding:"0",transition:"$all",opacity:"1",background:"#6663",margin:"1rem 0",borderRadius:"6px","&[data-information-panel='false']":{opacity:"0",marginTop:"-59px"},"@sm":{display:"flex","> span":{display:"flex",flexGrow:"1",fontSize:"0.8333em",justifyContent:"center",padding:"0.5rem",fontFamily:"inherit"}}}),Ze=f(ue.Content,{width:"100%",display:"flex"}),pn=f("aside",{display:"flex",flexGrow:"1",flexShrink:"0",width:"38.2%",maxHeight:"100%","@sm":{width:"100%"}}),fn=f("div",{display:"flex",flexDirection:"column",fontSmooth:"auto",webkitFontSmoothing:"antialiased",'&[data-absolute-position="true"]':{position:"absolute",width:"100%",height:"100%",zIndex:"0"},"> div":{display:"flex",flexDirection:"column",flexGrow:"1",justifyContent:"flex-start",height:"100%",maxHeight:"100%","@sm":{[`& ${je}`]:{flexGrow:"1"},[`& ${Ge}`]:{flexGrow:"0"}}},"@sm":{padding:"0"},"&[data-information-panel-open='true']":{"@sm":{position:"fixed",height:"100%",width:"100%",top:"0",left:"0",zIndex:"2500000000",[`& ${qe}`]:{display:"none"},[`& ${Ue}`]:{margin:"1rem"},[`& ${Ze}`]:{height:"100%"}}}}),hn=f(oe.Root,{display:"flex",flexDirection:"column",width:"100%",height:"100%",flexGrow:"1",flexShrink:"0",position:"relative",zIndex:"1",maskImage:"linear-gradient(180deg, rgba(0, 0, 0, 1) calc(100% - 2rem), transparent 100%)","@sm":{marginTop:"0.5rem",boxShadow:"none"}}),gn=f(oe.List,{display:"flex",flexGrow:"0",margin:"0 1.618rem",borderBottom:"4px solid #6663","@sm":{margin:"0 1rem"}}),se=f(oe.Trigger,{display:"flex",position:"relative",padding:"0.5rem 1rem",background:"none",backgroundColor:"transparent",fontFamily:"inherit",border:"none",opacity:"0.7",fontSize:"1rem",marginRight:"1rem",lineHeight:"1rem",whiteSpace:"nowrap",cursor:"pointer",fontWeight:400,transition:"$all","&::after":{width:"0",height:"4px",content:"",position:"absolute",bottom:"-4px",left:"0",transition:"$all"},"&[data-state='active']":{opacity:"1",fontWeight:700,"&::after":{width:"100%",backgroundColor:"$accent"}}}),ce=f(oe.Content,{display:"flex",flexGrow:"1",flexShrink:"0",position:"absolute",top:"0",left:"0","&[data-state='active']":{width:"100%",height:"calc(100% - 2rem)",padding:"1.618rem 0"}}),vn=f(({handleScroll:e,children:n,className:r})=>t.createElement("div",{className:r,onScroll:e},n),{position:"relative",height:"100%",width:"100%",overflowY:"scroll"}),Xe={position:"relative",cursor:"pointer",display:"flex",width:"100%",justifyContent:"space-between",textAlign:"left",margin:"0",padding:"0.5rem 1.618rem",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",color:"inherit",border:"none",background:"none"},Ye=f("button",{textAlign:"left","&:hover":{color:"$accent"}}),En=f("div",{display:"flex",flexDirection:"column",width:"100%"}),yn=f("div",{...Xe}),bn=f("div",{"&:hover":{color:"$accent"}}),Je=({value:e,handleClick:n})=>t.createElement(Ye,{onClick:n},e),xn=({value:e,handleClick:n})=>t.createElement(bn,{dangerouslySetInnerHTML:{__html:e},onClick:n}),wn=()=>{function e(o){return o.map(a=>{const l=a.identifier||ne.v4();return{...a,identifier:l}})}function n(o){var s;const a=[],l=[],c=e(o);for(const d of c){for(;l.length>0&&l[l.length-1].end<=d.start;)l.pop();l.length>0?(l[l.length-1].children||(l[l.length-1].children=[]),(s=l[l.length-1].children)==null||s.push(d),l.push(d)):(a.push(d),l.push(d))}return a}function r(o,a=[]){return a.some(l=>o.start>=l.start&&o.end<=l.end)}function i(o=[]){return o.sort((a,l)=>a.start-l.start)}return{addIdentifiersToParsedCues:e,createNestedCues:n,isChild:r,orderCuesByTime:i}},Ke=ve({from:{transform:"rotate(360deg)"},to:{transform:"rotate(0deg)"}}),Sn=f(ie.Root,{display:"flex",flexDirection:"column",width:"100%"}),Qe=f(ie.Item,{...Xe,"@sm":{padding:"0.5rem 1rem",fontSize:"0.8333rem"},"&::before":{content:"",width:"12px",height:"12px",borderRadius:"12px",position:"absolute",backgroundColor:"$primaryMuted",opacity:"0",left:"8px",marginTop:"3px",boxSizing:"content-box","@sm":{content:"unset"}},"&::after":{content:"",width:"4px",height:"6px",position:"absolute",backgroundColor:"$secondary",opacity:"0",clipPath:"polygon(100% 50%, 0 100%, 0 0)",left:"13px",marginTop:"6px",boxSizing:"content-box","@sm":{content:"unset"}},strong:{marginLeft:"1rem"},"&:hover":{color:"$accent","&::before":{backgroundColor:"$accent",opacity:"1"},"&::after":{content:"",width:"4px",height:"6px",position:"absolute",backgroundColor:"$secondary",clipPath:"polygon(100% 50%, 0 100%, 0 0)",opacity:"1"}},"&[aria-checked='true']":{backgroundColor:"#6663","&::before":{content:"",width:"6px",height:"6px",position:"absolute",backgroundColor:"transparent",border:"3px solid $accentMuted",borderRadius:"12px",left:"8px",marginTop:"4px",opacity:"1",animation:"1s linear infinite",animationName:Ke,boxSizing:"content-box","@sm":{content:"unset"}},"&::after":{content:"",width:"6px",height:"6px",position:"absolute",backgroundColor:"transparent",border:"3px solid $accent",clipPath:"polygon(100% 0, 100% 100%, 0 0)",borderRadius:"12px",left:"8px",marginTop:"4px",opacity:"1",animation:"1.5s linear infinite",animationName:Ke,boxSizing:"content-box","@sm":{content:"unset"}}}}),Cn=750,kn=e=>{for(;e&&e!==document.body;){const n=window.getComputedStyle(e).overflowY;if(n!=="visible"&&n!=="hidden"&&e.scrollHeight>e.clientHeight)return e;e=e.parentNode}return null},In=({label:e,start:n,end:r})=>{var g,v;const i=z(),{configOptions:o,isAutoScrollEnabled:a,isUserScrolling:l}=k(),c=(v=(g=o==null?void 0:o.informationPanel)==null?void 0:g.vtt)==null?void 0:v.autoScroll,[s,d]=t.useState(!1),h=t.useRef(null),u=document.getElementById("clover-iiif-video");t.useEffect(()=>(u==null||u.addEventListener("timeupdate",()=>{const{currentTime:m}=u;d(n<=m&&m<r)}),()=>document.removeEventListener("timeupdate",()=>{})),[r,n,u]),t.useEffect(()=>{var p;const m=E=>{i({type:"updateAutoScrolling",isAutoScrolling:!0}),E(),setTimeout(()=>i({type:"updateAutoScrolling",isAutoScrolling:!1}),Cn)};if(a&&s&&h.current&&!l){const E=h.current;if(E&&E instanceof HTMLElement){const b=kn(E);if(b&&b instanceof HTMLElement){let S;switch((p=c==null?void 0:c.settings)==null?void 0:p.block){case"center":const $=b.getBoundingClientRect();S=E.offsetTop+E.offsetHeight-Math.floor(($.bottom-$.top)/2);break;case"end":S=E.offsetTop+E.offsetHeight-(b.clientHeight-E.clientHeight)+2;break;default:S=E.offsetTop-2;break}m(()=>{var $;return b.scrollTo({top:S,left:0,behavior:($=c==null?void 0:c.settings)==null?void 0:$.behavior})})}}}},[c,s,l,a,i]);const y=()=>{u&&(u.pause(),u.currentTime=n,u.play())};return t.createElement(Qe,{ref:h,"aria-checked":s,"data-testid":"information-panel-cue",onClick:y,value:e},e,t.createElement("strong",null,Ae(n)))},$n=f("ul",{listStyle:"none",paddingLeft:"1rem",position:"relative","&&:first-child":{paddingLeft:"0"},"& li ul":{[`& ${Qe}`]:{backgroundColor:"unset","&::before":{content:"none"},"&::after":{content:"none"}}},"&:first-child":{margin:"0 0 1.618rem"}}),Re=({items:e})=>t.createElement($n,null,e.map(n=>{const{text:r,start:i,end:o,children:a,identifier:l}=n;return t.createElement("li",{key:l},t.createElement(In,{label:r,start:i,end:o}),a&&t.createElement(Re,{items:a}))})),An=({label:e,vttUri:n})=>{const[r,i]=t.useState([]),{createNestedCues:o,orderCuesByTime:a}=wn(),[l,c]=t.useState();return t.useEffect(()=>{n&&fetch(n,{headers:{"Content-Type":"text/plain",Accept:"application/json"}}).then(s=>s.text()).then(s=>{const d=Ft.parse(s).cues,h=a(d),u=o(h);i(u)}).catch(s=>{console.error(n,s.toString()),c(s)})},[n]),t.createElement(Sn,{"data-testid":"annotation-item-vtt","aria-label":`navigate ${Y(e,"en")}`},l&&t.createElement("div",{"data-testid":"error-message"},"Network Error: ",l.toString()),t.createElement(Re,{items:r}))},Tn=({caption:e,handleClick:n,imageUri:r})=>t.createElement(Ye,{onClick:n},t.createElement("img",{src:r,alt:`A visual annotation for ${e}`}),t.createElement("span",null,e)),Mn=({annotation:e})=>{var g,v;const{target:n}=e,r=k(),{openSeadragonViewer:i,vault:o,activeCanvas:a,configOptions:l}=r,c=e.body.map(m=>o.get(m.id)),s=((g=c.find(m=>m.format))==null?void 0:g.format)||"",d=((v=c.find(m=>m.value))==null?void 0:v.value)||"",h=o.get({id:a,type:"Canvas"});function u(){var p;if(!n)return;const m=((p=l.annotationOverlays)==null?void 0:p.zoomLevel)||1;fe(i,m,n,h)}function y(){var m,p;switch(s){case"text/plain":return t.createElement(Je,{value:d,handleClick:u});case"text/html":return t.createElement(xn,{value:d,handleClick:u});case"text/vtt":return t.createElement(An,{label:c[0].label,vttUri:c[0].id||""});case((m=s.match(/^image\//))==null?void 0:m.input):const E=((p=c.find(b=>{var S;return!((S=b.id)!=null&&S.includes("vault://"))}))==null?void 0:p.id)||"";return t.createElement(Tn,{caption:d,handleClick:u,imageUri:E});default:return t.createElement(Je,{value:d,handleClick:u})}}return t.createElement(yn,null,y())},Ln=({annotationPage:e})=>{var o;const n=k(),{vault:r}=n;if(!e||!e.items||((o=e.items)==null?void 0:o.length)===0)return t.createElement(t.Fragment,null);const i=e.items.map(a=>r.get(a.id));return i?t.createElement(En,{"data-testid":"annotation-page"},i==null?void 0:i.map(a=>t.createElement(Mn,{key:a.id,annotation:a}))):t.createElement(t.Fragment,null)},zn=f("button",{textAlign:"left","&:hover":{color:"$accent"}}),Fn=f("li",{margin:"0.25rem 0"}),Pn=f("ol",{listStyleType:"auto",marginBottom:"1rem",listStylePosition:"inside"}),Vn=f("div",{margin:"0.5rem 1.618rem"}),Bn=f("div",{fontWeight:"bold"}),On=f("div",{marginBottom:"1rem"}),Hn=({value:e,handleClick:n,target:r,canvas:i})=>t.createElement(zn,{onClick:n,"data-target":r,"data-canvas":i},e),_n=({annotation:e,activeContentSearchTarget:n,setActiveContentSearchTarget:r})=>{var S,$,L;const i=z(),o=k(),{openSeadragonViewer:a,vault:l,contentSearchVault:c,activeCanvas:s,configOptions:d,OSDImageLoaded:h}=o,u=l.get({id:s,type:"Canvas"}),g=((S=e.body.map(I=>c.get(I.id)).find(I=>I.value))==null?void 0:S.value)||"";let v;e.target&&typeof e.target=="string"&&(v=e.target);let m;if(v){const I=v.split("#xywh");I.length>1&&(m=I[0])}const p=((L=($=d.contentSearch)==null?void 0:$.overlays)==null?void 0:L.zoomLevel)||1;t.useEffect(()=>{h&&a&&e.target&&e.target==n&&fe(a,p,v,u)},[a,h]);function E(I){if(!a)return;const O=JSON.parse(I.target.dataset.target),H=I.target.dataset.canvas;s===H?fe(a,p,v,u):(i({type:"updateOSDImageLoaded",OSDImageLoaded:!1}),i({type:"updateActiveCanvas",canvasId:H}),r(O))}const b=JSON.stringify(v);return t.createElement(Fn,null,t.createElement(Hn,{target:b,canvas:m,value:g,handleClick:E}))},Dn=({annotationPage:e})=>{var u,y,g;const n=k(),{contentSearchVault:r,configOptions:i}=n,[o,a]=t.useState(),l=(u=i.contentSearch)==null?void 0:u.searchResultsLimit,c=(y=i.localeText)==null?void 0:y.contentSearch;function s(v){const m={};return v.items.forEach(p=>{const E=r.get(p.id);let b="";if(E.label){const S=Y(E.label);S&&(b=S[0])}m[b]==null&&(m[b]=[]),m[b].push(E)}),m}function d(v){return(l?v.slice(0,l):v).map((p,E)=>t.createElement(_n,{key:E,annotation:p,activeContentSearchTarget:o,setActiveContentSearchTarget:a}))}function h(v){if(l){const m=v.length-l;if(m>0)return t.createElement(On,null,m," ",c==null?void 0:c.moreResults)}}return!e||!e.items||((g=e.items)==null?void 0:g.length)===0?t.createElement("p",null,c==null?void 0:c.noSearchResults):t.createElement(t.Fragment,null,Object.entries(s(e)).map(([v,m],p)=>t.createElement("div",{key:p},t.createElement(Bn,{className:"content-search-results-title"},v),t.createElement(Pn,{className:"content-search-results"},d(m)),h(m))))},Nn=f("div",{".content-search-form":{display:"flex",marginBottom:"1rem"},input:{padding:".25rem",marginRight:"1rem"}}),Wn=f("button",{display:"flex",background:"none",border:"none",width:"2rem",height:"2rem",padding:"0",margin:"0",fontWeight:"700",borderRadius:"2rem",backgroundColor:"$accent",color:"$secondary",cursor:"pointer",boxSizing:"content-box",transition:"$all",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",opacity:"1",filter:"drop-shadow(5px 5px 5px #000D)",boxSizing:"inherit",transition:"$all"},"&:disabled":{backgroundColor:"transparent",boxShadow:"none",svg:{opacity:"0.25"}}}),qn=({searchServiceUrl:e,setContentSearchResource:n,setLoading:r})=>{var m;const[i,o]=t.useState(),[a,l]=t.useState("1"),c=k(),{contentSearchVault:s,openSeadragonViewer:d,configOptions:h}=c,u=(m=h.localeText)==null?void 0:m.contentSearch;async function y(p){p.preventDefault();const E=u==null?void 0:u.tabLabel;if(d&&e){if(!i||i.trim()===""){n({label:{none:[E]}});return}r(!0),Pe(s,e,E,{q:i,exact:a}).then(b=>{n(b),r(!1)})}}const g=p=>{p.preventDefault(),o(p.target.value)},v=p=>{console.log("set exact",p.target.checked),l(p.target.checked?"1":"0")};return t.createElement(Nn,null,t.createElement(X.Root,{onSubmit:y,className:"content-search-form"},t.createElement(X.Field,{className:"FormField",name:"searchTerms",onChange:g},t.createElement(X.Control,{placeholder:u==null?void 0:u.formPlaceholder})),t.createElement(X.Submit,{asChild:!0},t.createElement(Wn,{type:"submit"},t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},t.createElement("title",null,"Search"),t.createElement("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"})))),t.createElement(X.Field,{name:"exactMode",onChange:v},t.createElement(X.Control,{asChild:!0},t.createElement("p",{style:{margin:"0 0 0 10px"}},t.createElement("input",{type:"checkbox",value:"1",name:"exactMode"})," Exact?")))))},jn=({searchServiceUrl:e,setContentSearchResource:n,activeCanvas:r,annotationPage:i})=>{const[o,a]=t.useState(!1);return t.createElement(Vn,null,t.createElement(qn,{searchServiceUrl:e,setContentSearchResource:n,activeCanvas:r,setLoading:a}),!o&&t.createElement(Dn,{annotationPage:i}),o&&t.createElement("span",null,"Loading..."))},Gn=f("div",{padding:" 0 1.618rem 2rem",display:"flex",flexDirection:"column",overflow:"scroll",position:"absolute",fontWeight:"400",fontSize:"1rem",zIndex:"0",img:{maxWidth:"100px",maxHeight:"100px",objectFit:"contain",color:"transparent",margin:"0 0 1rem",borderRadius:"3px",backgroundColor:"$secondaryMuted"},video:{display:"none"},"a, a:visited":{color:"$accent"},p:{fontSize:"1rem",lineHeight:"1.45em",margin:"0"},dl:{margin:"0",dt:{fontWeight:"700",margin:"1rem 0 0.25rem"},dd:{margin:"0"}},".manifest-property-title":{fontWeight:"700",margin:"1rem 0 0.25rem"},"ul, ol":{padding:"0",margin:"0",li:{fontSize:"1rem",lineHeight:"1.45em",listStyle:"none",margin:"0.25rem 0 0.25rem"}}}),Un=f("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),et=(e,n="none")=>{if(!e)return null;if(typeof e=="string")return[e];if(!e[n]){const r=Object.getOwnPropertyNames(e);if(r.length>0)return e[r[0]]}return!e[n]||!Array.isArray(e[n])?null:e[n]},F=(e,n="none",r=", ")=>{const i=et(e,n);return Array.isArray(i)?i.join(`${r}`):i};function Zn(e){return{__html:Xn(e)}}function B(e,n){const r=Object.keys(e).filter(o=>n.includes(o)?null:o),i=new Object;return r.forEach(o=>{i[o]=e[o]}),i}function Xn(e){return Vt(e,{allowedAttributes:{a:["href"],img:["alt","src","height","width"]},allowedSchemes:["http","https","mailto"],allowedTags:["a","b","br","i","img","p","small","span","sub","sup"]})}const Yn=f("span",{}),W=e=>{const{as:n,label:r}=e,o=B(e,["as","label"]);return t.createElement(Yn,{as:n,...o},F(r,o.lang))},Jn=(e,n="200,",r="full")=>{Array.isArray(e)&&(e=e[0]);const{id:i,service:o}=e;let a;if(!o)return i;if(Array.isArray(e.service)&&e.service.length>0&&(a=o[0]),a){if(a["@id"])return`${a["@id"]}/${r}/${n}/0/default.jpg`;if(a.id)return`${a.id}/${r}/${n}/0/default.jpg`}},tt=f("img",{objectFit:"cover"}),Kn=e=>{const n=t.useRef(null),{contentResource:r,altAsLabel:i,region:o="full"}=e;let a;i&&(a=F(i));const c=B(e,["contentResource","altAsLabel"]),{type:s,id:d,width:h=200,height:u=200,duration:y}=r;t.useEffect(()=>{if(!d&&!n.current||["Image"].includes(s)||!d.includes("m3u8"))return;const m=new P;return n.current&&(m.attachMedia(n.current),m.on(P.Events.MEDIA_ATTACHED,function(){m.loadSource(d)})),m.on(P.Events.ERROR,function(p,E){if(E.fatal)switch(E.type){case P.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${p} network error encountered, try to recover`),m.startLoad();break;case P.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${p} media error encountered, try to recover`),m.recoverMediaError();break;default:m.destroy();break}}),()=>{m&&(m.detachMedia(),m.destroy())}},[d,s]);const g=t.useCallback(()=>{if(!n.current)return;let m=0,p=30;if(y&&(p=y),!d.split("#t=")&&y&&(m=y*.1),d.split("#t=").pop()){const b=d.split("#t=").pop();b&&(m=parseInt(b.split(",")[0]))}const E=n.current;E.autoplay=!0,E.currentTime=m,setTimeout(()=>g(),p*1e3)},[y,d]);t.useEffect(()=>g(),[g]);const v=Jn(r,`${h},${u}`,o);switch(s){case"Image":return t.createElement(tt,{as:"img",alt:a,css:{width:h,height:u},key:d,src:v,...c});case"Video":return t.createElement(tt,{as:"video",css:{width:h,height:u},disablePictureInPicture:!0,key:d,loop:!0,muted:!0,onPause:g,ref:n,src:d});default:return console.warn(`Resource type: ${s} is not valid or not yet supported in Primitives.`),t.createElement(t.Fragment,null)}},Qn=f("a",{}),Rn=e=>{const{children:n,homepage:r}=e,o=B(e,["children","homepage"]);return t.createElement(t.Fragment,null,r&&r.map(a=>{const l=F(a.label,o.lang);return t.createElement(Qn,{"aria-label":n?l:void 0,href:a.id,key:a.id,...o},n||l)}))},er={delimiter:", "},Ee=t.createContext(void 0),nt=()=>{const e=t.useContext(Ee);if(e===void 0)throw new Error("usePrimitivesContext must be used with a PrimitivesProvider");return e},ye=({children:e,initialState:n=er})=>{const r=tr(n,"delimiter");return t.createElement(Ee.Provider,{value:{delimiter:r}},e)},tr=(e,n)=>Object.hasOwn(e,n)?e[n].toString():void 0,nr=f("span",{}),rt=e=>{const{as:n,markup:r}=e,{delimiter:i}=nt();if(!r)return t.createElement(t.Fragment,null);const a=B(e,["as","markup"]),l=Zn(F(r,a.lang,i));return t.createElement(nr,{as:n,...a,dangerouslySetInnerHTML:l})},ot=e=>t.useContext(Ee)?t.createElement(rt,{...e}):t.createElement(ye,null,t.createElement(rt,{...e})),rr=({as:e="dd",lang:n,value:r})=>t.createElement(ot,{markup:r,as:e,lang:n}),or=f("span",{}),ir=({as:e="dd",customValueContent:n,lang:r,value:i})=>{var l;const{delimiter:o}=nt(),a=(l=et(i,r))==null?void 0:l.map(c=>t.cloneElement(n,{value:c}));return t.createElement(or,{as:e,lang:r},a==null?void 0:a.map((c,s)=>[s>0&&`${o}`,t.createElement(t.Fragment,{key:s},c)]))},it=e=>{var c;const{item:n,lang:r,customValueContent:i}=e,{label:o,value:a}=n,l=(c=F(o))==null?void 0:c.replace(" ","-").toLowerCase();return t.createElement("div",{role:"group","data-label":l},t.createElement(W,{as:"dt",label:o,lang:r}),i?t.createElement(ir,{as:"dd",customValueContent:i,value:a,lang:r}):t.createElement(rr,{as:"dd",value:a,lang:r}))};function ar(e,n){const r=n.filter(i=>{const{matchingLabel:o}=i,a=Object.keys(i.matchingLabel)[0],l=F(o,a);if(F(e,a)===l)return!0}).map(i=>i.Content);if(Array.isArray(r))return r[0]}const lr=f("dl",{}),sr=e=>{const{as:n,customValueContent:r,metadata:i}=e;if(!Array.isArray(i))return t.createElement(t.Fragment,null);const o=Me(e,"customValueDelimiter"),l=B(e,["as","customValueContent","customValueDelimiter","metadata"]);return t.createElement(ye,{...typeof o=="string"?{initialState:{delimiter:o}}:void 0},i.length>0&&t.createElement(lr,{as:n,...l},i.map((c,s)=>{const d=r?ar(c.label,r):void 0;return t.createElement(it,{customValueContent:d,item:c,key:s,lang:l==null?void 0:l.lang})})))};f("li",{}),f("ul",{});const cr=f("li",{}),dr=f("ul",{}),ur=e=>{const{as:n,rendering:r}=e,o=B(e,["as","rendering"]);return t.createElement(dr,{as:n},r&&r.map(a=>{const l=F(a.label,o.lang);return t.createElement(cr,{key:a.id},t.createElement("a",{href:a.id,...o,target:"_blank"},l||a.id))}))},mr=f("dl",{}),pr=e=>{const{as:n,requiredStatement:r}=e;if(!r)return t.createElement(t.Fragment,null);const i=Me(e,"customValueDelimiter"),a=B(e,["as","customValueDelimiter","requiredStatement"]);return t.createElement(ye,{...typeof i=="string"?{initialState:{delimiter:i}}:void 0},t.createElement(mr,{as:n,...a},t.createElement(it,{item:r,lang:a.lang})))},fr=f("li",{}),hr=f("ul",{}),gr=e=>{const{as:n,seeAlso:r}=e,o=B(e,["as","seeAlso"]);return t.createElement(hr,{as:n},r&&r.map(a=>{const l=F(a.label,o.lang);return t.createElement(fr,{key:a.id},t.createElement("a",{href:a.id,...o},l||a.id))}))},vr=e=>{const{as:n,summary:r}=e,o=B(e,["as","customValueDelimiter","summary"]);return t.createElement(ot,{as:n,markup:r,...o})},at=e=>{const{thumbnail:n,region:r}=e,o=B(e,["thumbnail"]);return t.createElement(t.Fragment,null,n&&n.map(a=>t.createElement(Kn,{contentResource:a,key:a.id,region:r,...o})))},Er=({homepage:e})=>(e==null?void 0:e.length)===0?t.createElement(t.Fragment,null):t.createElement(t.Fragment,null,t.createElement("span",{className:"manifest-property-title"},"Homepage"),t.createElement(Rn,{homepage:e})),yr=({id:e,htmlLabel:n,parent:r="manifest"})=>t.createElement(t.Fragment,null,t.createElement("span",{className:"manifest-property-title"},n),t.createElement("a",{href:e,target:"_blank",id:`iiif-${r}-id`},e)),br=({metadata:e,parent:n="manifest"})=>e?t.createElement(t.Fragment,null,t.createElement(sr,{metadata:e,id:`iiif-${n}-metadata`})):t.createElement(t.Fragment,null),xr=({rendering:e})=>(e==null?void 0:e.length)===0?t.createElement(t.Fragment,null):t.createElement(t.Fragment,null,t.createElement("span",{className:"manifest-property-title"},"Alternate formats"),t.createElement(ur,{rendering:e})),wr=({requiredStatement:e,parent:n="manifest"})=>e?t.createElement(t.Fragment,null,t.createElement(pr,{requiredStatement:e,id:`iiif-${n}-required-statement`})):t.createElement(t.Fragment,null),Sr=({rights:e})=>e?t.createElement(t.Fragment,null,t.createElement("span",{className:"manifest-property-title"},"Rights"),t.createElement("a",{href:e,target:"_blank"},e)):t.createElement(t.Fragment,null),Cr=({seeAlso:e})=>(e==null?void 0:e.length)===0?t.createElement(t.Fragment,null):t.createElement(t.Fragment,null,t.createElement("span",{className:"manifest-property-title"},"See Also"),t.createElement(gr,{seeAlso:e})),kr=({summary:e,parent:n="manifest"})=>e?t.createElement(t.Fragment,null,t.createElement(vr,{summary:e,as:"p",id:`iiif-${n}-summary`})):t.createElement(t.Fragment,null),Ir=({label:e,thumbnail:n})=>(n==null?void 0:n.length)===0?t.createElement(t.Fragment,null):t.createElement(t.Fragment,null,t.createElement(at,{altAsLabel:e||{none:["resource"]},thumbnail:n,style:{backgroundColor:"#6663",objectFit:"cover"}})),$r=()=>{const e=k(),{activeManifest:n,vault:r}=e,[i,o]=t.useState(),[a,l]=t.useState([]),[c,s]=t.useState([]),[d,h]=t.useState([]),[u,y]=t.useState([]);return t.useEffect(()=>{var v,m,p,E;const g=r.get(n);o(g),((v=g.homepage)==null?void 0:v.length)>0&&l(r.get(g.homepage)),((m=g.seeAlso)==null?void 0:m.length)>0&&s(r.get(g.seeAlso)),((p=g.rendering)==null?void 0:p.length)>0&&h(r.get(g.rendering)),((E=g.thumbnail)==null?void 0:E.length)>0&&y(r.get(g.thumbnail))},[n,r]),i?t.createElement(Un,null,t.createElement(Gn,null,t.createElement(Ir,{thumbnail:u,label:i.label}),t.createElement(kr,{summary:i.summary}),t.createElement(br,{metadata:i.metadata}),t.createElement(wr,{requiredStatement:i.requiredStatement}),t.createElement(Sr,{rights:i.rights}),t.createElement(Er,{homepage:a}),t.createElement(Cr,{seeAlso:c}),t.createElement(xr,{rendering:d}),t.createElement(yr,{id:i.id,htmlLabel:"IIIF Manifest"}))):t.createElement(t.Fragment,null)};function Ar(e){const n=[];return e.forEach(r=>{var i;(i=r.informationPanel)!=null&&i.component&&n.push(r)}),{pluginsWithInfoPanel:n}}const Tr=1500,Mr=({activeCanvas:e,annotationResources:n,searchServiceUrl:r,setContentSearchResource:i,contentSearchResource:o})=>{const a=z(),l=k(),{isAutoScrolling:c,configOptions:{informationPanel:s},configOptions:d,isUserScrolling:h,vault:u,plugins:y,activeManifest:g,openSeadragonViewer:v}=l,m=u.get({id:e,type:"Canvas"}),[p,E]=t.useState(),b=s==null?void 0:s.renderAbout,S=s==null?void 0:s.renderAnnotation,$=s==null?void 0:s.renderContentSearch,{pluginsWithInfoPanel:L}=Ar(y);function I(w,A){var D,q;const _=(D=w==null?void 0:w.informationPanel)==null?void 0:D.component;return _===void 0?t.createElement(t.Fragment,null):t.createElement(ce,{key:A,value:w.id},t.createElement(_,{...(q=w==null?void 0:w.informationPanel)==null?void 0:q.componentProps,activeManifest:g,canvas:m,viewerConfigOptions:d,openSeadragonViewer:v,useViewerDispatch:z,useViewerState:k}))}t.useEffect(()=>{if(!p)if(s!=null&&s.defaultTab){const w=["manifest-about","manifest-content-search"];m.annotations.length>0&&m.annotations.forEach(A=>w.push(A.id)),w.includes(s==null?void 0:s.defaultTab)?E(s.defaultTab):E("manifest-about")}else b?E("manifest-about"):$?E("manifest-content-search"):n&&(n==null?void 0:n.length)>0&&E(n[0].id)},[s==null?void 0:s.defaultTab,e,p,b,$,n,o,m==null?void 0:m.annotations,y]);function O(){if(!c){clearTimeout(h);const w=setTimeout(()=>{a({type:"updateUserScrolling",isUserScrolling:void 0})},Tr);a({type:"updateUserScrolling",isUserScrolling:w})}}const H=w=>{E(w)};return t.createElement(hn,{"data-testid":"information-panel",defaultValue:p,onValueChange:H,orientation:"horizontal",value:p,className:"clover-viewer-information-panel"},t.createElement(gn,{"aria-label":"select chapter","data-testid":"information-panel-list"},$&&o&&t.createElement(se,{value:"manifest-content-search"},t.createElement(W,{label:o.label})),S&&n&&n.map((w,A)=>t.createElement(se,{key:A,value:w.id},t.createElement(W,{label:w.label}))),L&&L.map((w,A)=>{var _;return t.createElement(se,{key:A,value:w.id},t.createElement(W,{label:(_=w.informationPanel)==null?void 0:_.label}))}),b&&t.createElement(se,{value:"manifest-about"},"About")),t.createElement(vn,{handleScroll:O},$&&o&&t.createElement(ce,{value:"manifest-content-search"},t.createElement(jn,{searchServiceUrl:r,setContentSearchResource:i,activeCanvas:e,annotationPage:o})),S&&n&&n.map(w=>t.createElement(ce,{key:w.id,value:w.id},t.createElement(Ln,{annotationPage:w}))),L&&L.map((w,A)=>I(w,A)),b&&t.createElement(ce,{value:"manifest-about"},t.createElement($r,null))))},lt=f("div",{position:"absolute",right:"1rem",top:"1rem",display:"flex",justifyContent:"flex-end",zIndex:"1"}),Lr=f("input",{flexGrow:"1",border:"none",backgroundColor:"$secondaryMuted",color:"$primary",marginRight:"1rem",height:"2rem",padding:"0 1rem",borderRadius:"2rem",fontFamily:"inherit",fontSize:"1rem",lineHeight:"1rem",boxShadow:"inset 1px 1px 2px #0003","&::placeholder":{color:"$primaryMuted"}}),be=f("button",{display:"flex",background:"none",border:"none",width:"2rem !important",height:"2rem !important",padding:"0",margin:"0",fontWeight:"700",borderRadius:"2rem",backgroundColor:"$accent",color:"$secondary",cursor:"pointer",boxSizing:"content-box !important",transition:"$all",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",opacity:"1",filter:"drop-shadow(5px 5px 5px #000D)",boxSizing:"inherit",transition:"$all"},"&:disabled":{backgroundColor:"transparent",boxShadow:"none",svg:{opacity:"0.25"}}}),zr=f("div",{display:"flex",marginRight:"0.618rem",backgroundColor:"$accentAlt",borderRadius:"2rem",boxShadow:"5px 5px 5px #0003",color:"$secondary",alignItems:"center","> span":{display:"flex",margin:"0 0.5rem",fontSize:"0.7222rem"}}),Fr=f("div",{display:"flex",position:"relative",zIndex:"1",width:"100%",padding:"0",transition:"$all",variants:{isToggle:{true:{paddingTop:"2.618rem",[`& ${lt}`]:{width:"calc(100% - 2rem)","@sm":{width:"calc(100% - 2rem)"}}}}}}),Pr=(e,n)=>{t.useEffect(()=>{function r(i){i.key===e&&n()}return window.addEventListener("keyup",r),()=>window.removeEventListener("keyup",r)},[])},Vr=()=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},t.createElement("title",null,"Arrow Back"),t.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M244 400L100 256l144-144M120 256h292"})),Br=()=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},t.createElement("title",null,"Arrow Forward"),t.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M268 112l144 144-144 144M392 256H100"})),Or=()=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},t.createElement("title",null,"Close"),t.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),Hr=()=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},t.createElement("title",null,"Search"),t.createElement("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"})),_r=({handleCanvasToggle:e,handleFilter:n,activeIndex:r,canvasLength:i})=>{const[o,a]=t.useState(!1),[l,c]=t.useState(!1),[s,d]=t.useState(!1);t.useEffect(()=>{d(r===0),r===i-1?c(!0):c(!1)},[r,i]),Pr("Escape",()=>{a(!1),n("")});const h=()=>{a(y=>!y),n("")},u=y=>n(y.target.value);return t.createElement(Fr,{isToggle:o},t.createElement(lt,null,o&&t.createElement(Lr,{autoFocus:!0,onChange:u,placeholder:"Search"}),!o&&t.createElement(zr,null,t.createElement(be,{onClick:()=>e(-1),disabled:s,type:"button"},t.createElement(Vr,null)),t.createElement("span",null,r+1," of ",i),t.createElement(be,{onClick:()=>e(1),disabled:l,type:"button"},t.createElement(Br,null))),t.createElement(be,{onClick:h,type:"button"},o?t.createElement(Or,null):t.createElement(Hr,null))))},Dr=f(ie.Root,{display:"flex",flexDirection:"row",flexGrow:"1",padding:"1.618rem",overflowX:"scroll",position:"relative",zIndex:"0"}),Nr=()=>t.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M256 112v288M400 256H112"}),Wr=()=>t.createElement(t.Fragment,null,t.createElement("path",{d:"M232 416a23.88 23.88 0 01-14.2-4.68 8.27 8.27 0 01-.66-.51L125.76 336H56a24 24 0 01-24-24V200a24 24 0 0124-24h69.75l91.37-74.81a8.27 8.27 0 01.66-.51A24 24 0 01256 120v272a24 24 0 01-24 24zm-106.18-80zm-.27-159.86zM320 336a16 16 0 01-14.29-23.19c9.49-18.87 14.3-38 14.3-56.81 0-19.38-4.66-37.94-14.25-56.73a16 16 0 0128.5-14.54C346.19 208.12 352 231.44 352 256c0 23.86-6 47.81-17.7 71.19A16 16 0 01320 336z"}),t.createElement("path",{d:"M368 384a16 16 0 01-13.86-24C373.05 327.09 384 299.51 384 256c0-44.17-10.93-71.56-29.82-103.94a16 16 0 0127.64-16.12C402.92 172.11 416 204.81 416 256c0 50.43-13.06 83.29-34.13 120a16 16 0 01-13.87 8z"}),t.createElement("path",{d:"M416 432a16 16 0 01-13.39-24.74C429.85 365.47 448 323.76 448 256c0-66.5-18.18-108.62-45.49-151.39a16 16 0 1127-17.22C459.81 134.89 480 181.74 480 256c0 64.75-14.66 113.63-50.6 168.74A16 16 0 01416 432z"})),qr=()=>t.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"}),jr=()=>t.createElement(t.Fragment,null,t.createElement("path",{d:"M336 176h40a40 40 0 0140 40v208a40 40 0 01-40 40H136a40 40 0 01-40-40V216a40 40 0 0140-40h40",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32"}),t.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M176 272l80 80 80-80M256 48v288"})),Gr=()=>t.createElement("path",{d:"M416 64H96a64.07 64.07 0 00-64 64v256a64.07 64.07 0 0064 64h320a64.07 64.07 0 0064-64V128a64.07 64.07 0 00-64-64zm-80 64a48 48 0 11-48 48 48.05 48.05 0 0148-48zM96 416a32 32 0 01-32-32v-67.63l94.84-84.3a48.06 48.06 0 0165.8 1.9l64.95 64.81L172.37 416zm352-32a32 32 0 01-32 32H217.63l121.42-121.42a47.72 47.72 0 0161.64-.16L448 333.84z"}),Ur=()=>t.createElement("path",{d:"M464 384.39a32 32 0 01-13-2.77 15.77 15.77 0 01-2.71-1.54l-82.71-58.22A32 32 0 01352 295.7v-79.4a32 32 0 0113.58-26.16l82.71-58.22a15.77 15.77 0 012.71-1.54 32 32 0 0145 29.24v192.76a32 32 0 01-32 32zM268 400H84a68.07 68.07 0 01-68-68V180a68.07 68.07 0 0168-68h184.48A67.6 67.6 0 01336 179.52V332a68.07 68.07 0 01-68 68z"}),st=f("svg",{display:"inline-flex",variants:{isLarge:{true:{height:"4rem",width:"4rem"}},isMedium:{true:{height:"2rem",width:"2rem"}},isSmall:{true:{height:"1rem",width:"1rem"}}}}),Zr=({children:e})=>t.createElement("title",null,e),T=e=>t.createElement(st,{...e,"data-testid":"icon-svg",role:"img",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg"},e.children);T.Title=Zr,T.Add=Nr,T.Audio=Wr,T.Close=qr,T.Download=jr,T.Image=Gr,T.Video=Ur;const Xr=ve({"0%":{opacity:0,transform:"translateY(1rem)"},"100%":{opacity:1,transform:"translateY(0)"}}),Yr=ve({"0%":{opacity:0,transform:"translateY(1rem)"},"100%":{opacity:1,transform:"translateY(0)"}}),ct=f(K.Arrow,{fill:"$secondaryAlt"}),Jr=f(K.Close,{position:"absolute",right:"0",top:"0",padding:"0.5rem",margin:"0",cursor:"pointer",border:"none",background:"none",fill:"inherit","&:hover":{opacity:"0.75"}}),Kr=f(K.Content,{border:"none",backgroundColor:"white",fill:"inhrerit",padding:"1rem 2rem 1rem 1rem",width:"auto",minWidth:"200px",maxWidth:"350px",borderRadius:"3px",boxShadow:"5px 5px 13px #0002",animationDuration:"0.3s",animationTimingFunction:"cubic-bezier(0.16, 1, 0.3, 1)",'&[data-side="top"]':{animationName:Yr},'&[data-side="bottom"]':{animationName:Xr},'&[data-align="end"]':{[`& ${ct}`]:{margin:"0 0.7rem"}}}),Qr=f(K.Trigger,{display:"inline-flex",padding:"0.5rem 0",margin:"0 0.5rem 0 0",cursor:"pointer",border:"none",background:"none","> button, > span":{margin:"0"}}),Rr=f(K.Root,{boxSizing:"content-box"}),eo=e=>t.createElement(Qr,{...e},e.children),to=e=>t.createElement(Kr,{...e},t.createElement(ct,null),t.createElement(Jr,null,t.createElement(T,{isSmall:!0},t.createElement(T.Close,null))),e.children),Z=({children:e})=>t.createElement(Rr,null,e);Z.Trigger=eo,Z.Content=to;const xe=f("div",{boxSizing:"border-box",display:"inline-flex",alignItems:"center",borderRadius:"5px",padding:"$1",marginBottom:"$2",marginRight:"$2",backgroundColor:"$lightGrey",color:"$richBlack50",textTransform:"uppercase",fontSize:"$2",objectFit:"contain",lineHeight:"1em !important","&:last-child":{marginRight:"0"},[`${st}`]:{position:"absolute",left:"$1",height:"$3",width:"$3"},variants:{isIcon:{true:{position:"relative",paddingLeft:"$5"}}}}),we=f("span",{display:"flex"}),no=f("span",{display:"flex",width:"1.2111rem",height:"0.7222rem"}),ro=f("span",{display:"inline-flex",marginLeft:"5px",marginBottom:"-1px"}),oo=f(ie.Item,{display:"flex",flexShrink:"0",margin:"0 1.618rem 0 0",padding:"0",cursor:"pointer",background:"none",border:"none",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",textAlign:"left","&:last-child":{marginRight:"1rem"},figure:{margin:"0",width:"161.8px","> div":{position:"relative",display:"flex",backgroundColor:"$secondaryAlt",width:"inherit",height:"100px",overflow:"hidden",borderRadius:"3px",transition:"$all",img:{width:"100%",height:"100%",objectFit:"cover",filter:"blur(0)",transform:"scale3d(1, 1, 1)",transition:"$all",color:"transparent"},[`& ${we}`]:{position:"absolute",right:"0",bottom:"0",[`& ${xe}`]:{margin:"0",paddingLeft:"0",fontSize:"0.7222rem",backgroundColor:"#000d",color:"$secondary",fill:"$secondary",borderBottomLeftRadius:"0",borderTopRightRadius:"0"}}},figcaption:{marginTop:"0.5rem",fontWeight:"400",fontSize:"0.8333rem",display:"-webkit-box",overflow:"hidden",MozBoxOrient:"vertical",WebkitBoxOrient:"vertical",WebkitLineClamp:"5","@sm":{fontSize:"0.8333rem"}}},"&[aria-checked='true']":{figure:{"> div":{backgroundColor:"$primaryAlt","&::before":{position:"absolute",zIndex:"1",color:"$secondaryMuted",content:"Active Item",textTransform:"uppercase",fontWeight:"700",fontSize:"0.6111rem",letterSpacing:"0.03rem",display:"flex",width:"100%",height:"100%",flexDirection:"column",justifyContent:"center",textAlign:"center",textShadow:"5px 5px 5px #0003"},img:{opacity:"0.3",transform:"scale3d(1.1, 1.1, 1.1)",filter:"blur(2px)"},[`& ${we}`]:{[`& ${xe}`]:{backgroundColor:"$accent"}}}},figcaption:{fontWeight:"700"}}}),io=({type:e})=>{switch(e){case"Sound":return t.createElement(T.Audio,null);case"Image":return t.createElement(T.Image,null);case"Video":return t.createElement(T.Video,null);default:return t.createElement(T.Image,null)}},ao=({canvas:e,canvasIndex:n,isActive:r,thumbnail:i,type:o,handleChange:a})=>t.createElement(oo,{"aria-checked":r,"data-testid":"media-thumbnail","data-canvas":n,onClick:()=>a(e.id),value:e.id},t.createElement("figure",null,t.createElement("div",null,(i==null?void 0:i.id)&&t.createElement("img",{src:i.id,alt:e!=null&&e.label?Y(e.label):""}),t.createElement(we,null,t.createElement(xe,{isIcon:!0,"data-testid":"thumbnail-tag"},t.createElement(no,null),t.createElement(T,{"aria-label":o},t.createElement(io,{type:o})),["Video","Sound"].includes(o)&&t.createElement(ro,null,Ae(e.duration))))),(e==null?void 0:e.label)&&t.createElement("figcaption",{"data-testid":"fig-caption"},t.createElement(W,{label:e.label})))),lo=e=>e.body?e.body.type:"Image",so=({items:e})=>{const n=z(),r=k(),{activeCanvas:i,vault:o}=r,[a,l]=t.useState(""),[c,s]=t.useState([]),[d,h]=t.useState(0),u=t.useRef(null),y="painting",g=p=>{i!==p&&n({type:"updateActiveCanvas",canvasId:p})};t.useEffect(()=>{if(!c.length){const p=["Image","Sound","Video"],E=e.map(b=>Ve(o,b,y,p)).filter(b=>b.annotations.length>0);s(E)}},[e,c.length,o]),t.useEffect(()=>{c.forEach((p,E)=>{p!=null&&p.canvas&&p.canvas.id===i&&h(E)})},[i,c]),t.useEffect(()=>{const p=document.querySelector(`[data-canvas="${d}"]`);if(p instanceof HTMLElement&&u.current){const E=p.offsetLeft-u.current.offsetWidth/2+p.offsetWidth/2;u.current.scrollTo({left:E,behavior:"smooth"})}},[d]);const v=p=>l(p),m=p=>{const E=c[d+p];E!=null&&E.canvas&&g(E.canvas.id)};return t.createElement(t.Fragment,null,t.createElement(_r,{handleFilter:v,handleCanvasToggle:m,activeIndex:d,canvasLength:c.length}),t.createElement(Dr,{"aria-label":"select item","data-testid":"media",ref:u},c.filter(p=>{var E;if((E=p.canvas)!=null&&E.label){const b=Y(p.canvas.label);if(Array.isArray(b))return b[0].toLowerCase().includes(a.toLowerCase())}}).map((p,E)=>{var b,S;return t.createElement(ao,{canvas:p.canvas,canvasIndex:E,handleChange:g,isActive:i===((b=p==null?void 0:p.canvas)==null?void 0:b.id),key:(S=p==null?void 0:p.canvas)==null?void 0:S.id,thumbnail:Ut(o,p,200,200),type:lo(p.annotations[0])})})))},dt=f("button",{position:"absolute",background:"none",border:"none",cursor:"zoom-in",margin:"0",padding:"0",width:"100%",height:"100%",transition:"$all","& img":{width:"100%",height:"100%",objectFit:"contain",color:"transparent",transition:"$all"},variants:{isMedia:{true:{cursor:"pointer"}}}}),ut=f("button",{display:"flex",height:"2rem",width:"2rem",borderRadius:"2rem",padding:"0",margin:"0",fontFamily:"inherit",background:"none",backgroundColor:"$primary",border:"none",color:"white",cursor:"pointer",marginLeft:"0.618rem",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"content-box !important","&:first-child":{marginLeft:"0"},"@xs":{marginBottom:"0.618rem",marginLeft:"0","&:last-child":{marginBottom:"0"}},svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"inherit"},"&:hover, &:focus":{backgroundColor:"$accent"},"&[data-button=rotate-right]":{"&:hover, &:focus":{svg:{rotate:"45deg"}}},"&[data-button=rotate-left]":{transform:"scaleX(-1)","&:hover, &:focus":{svg:{rotate:"45deg"}}},"&[data-button=reset]":{"&:hover, &:focus":{svg:{rotate:"-15deg"}}}}),mt=f(ut,{position:"absolute",width:"2rem",top:"1rem",right:"1rem",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",transition:"$all",borderRadius:"50%",backgroundColor:"$accent",cursor:"pointer","&:hover, &:focus":{backgroundColor:"$accent !important"},variants:{isInteractive:{true:{"&:hover":{opacity:"1"}},false:{}},isMedia:{true:{cursor:"pointer !important"}}},compoundVariants:[{isInteractive:!1,isMedia:!0,css:{top:"50%",right:"50%",width:"4rem",height:"4rem",transform:"translate(50%,-50%)"}}]}),co=f("div",{position:"relative",display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",gap:"1rem",zIndex:"0",overflow:"hidden","&:hover":{[`${mt}`]:{backgroundColor:"$accent"},[`${dt}`]:{backgroundColor:"#6662"}}}),uo=f("div",{width:"100%",height:"100%"}),mo=f("svg",{height:"19px",color:"$accent",fill:"$accent",stroke:"$accent",display:"flex",margin:"0.25rem 0.85rem"}),po=f(Q.Trigger,{fontSize:"1.25rem",fontWeight:"400",fontFamily:"inherit",alignSelf:"flex-start",flexGrow:"1",cursor:"pointer",transition:"$all",border:"1px solid #6663",boxShadow:"2px 2px 5px #0001",borderRadius:"3px",display:"flex",alignItems:"center",paddingLeft:"0.5rem",width:"100%","@sm":{fontSize:"1rem"}}),fo=f(Q.Content,{borderRadius:"3px",boxShadow:"3px 3px 8px #0003",backgroundColor:"$secondary",marginTop:"2.25rem",marginLeft:"6px",paddingBottom:"0.25rem",maxHeight:"calc(61.8vh - 2.5rem) !important",borderTopLeftRadius:"0",border:"1px solid $secondaryMuted",maxWidth:"90vw"}),ho=f(Q.Item,{display:"flex",alignItems:"center",fontFamily:"inherit",padding:"0.25rem 0.5rem",color:"$primary",fontWeight:"400",fontSize:"0.8333rem",cursor:"pointer",backgroundColor:"$secondary",width:"calc(100% - 1rem)","> span":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},'&[data-state="checked"]':{fontWeight:"700",color:"$primary !important"},"&:hover":{color:"$accent"},img:{width:"31px",height:"31px",marginRight:"0.5rem",borderRadius:"3px"}}),go=f(Q.Label,{color:"$primaryMuted",fontFamily:"inherit",fontSize:"0.85rem",padding:"0.5rem 1rem 0.5rem 0.5rem",display:"flex",alignItems:"center",marginBottom:"0.25rem",borderRadius:"3px",borderTopLeftRadius:"0",borderBottomLeftRadius:"0",borderBottomRightRadius:"0",backgroundColor:"$secondaryMuted"}),pt=f(Q.Root,{position:"relative",zIndex:"5",width:"100%"}),Se=({direction:e,title:n})=>{const r=()=>t.createElement("path",{d:"M414 321.94L274.22 158.82a24 24 0 00-36.44 0L98 321.94c-13.34 15.57-2.28 39.62 18.22 39.62h279.6c20.5 0 31.56-24.05 18.18-39.62z"}),i=()=>t.createElement("path",{d:"M98 190.06l139.78 163.12a24 24 0 0036.44 0L414 190.06c13.34-15.57 2.28-39.62-18.22-39.62h-279.6c-20.5 0-31.56 24.05-18.18 39.62z"});return t.createElement(mo,{xmlns:"http://www.w3.org/2000/svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},t.createElement("title",null,n),e==="up"&&t.createElement(r,null),e==="down"&&t.createElement(i,null))},ft=({children:e,label:n,maxHeight:r,onValueChange:i,value:o})=>t.createElement(pt,{onValueChange:i,value:o},t.createElement(po,{"data-testid":"select-button"},t.createElement(V.SelectValue,{"data-testid":"select-button-value"}),t.createElement(V.SelectIcon,null,t.createElement(Se,{direction:"down",title:"select"}))),t.createElement(V.SelectPortal,null,t.createElement(fo,{css:{maxHeight:`${r} !important`},"data-testid":"select-content"},t.createElement(V.SelectScrollUpButton,null,t.createElement(Se,{direction:"up",title:"scroll up for more"})),t.createElement(V.SelectViewport,null,t.createElement(V.SelectGroup,null,n&&t.createElement(go,null,t.createElement(W,{"data-testid":"select-label",label:n})),e)),t.createElement(V.SelectScrollDownButton,null,t.createElement(Se,{direction:"down",title:"scroll down for more"}))))),ht=e=>t.createElement(ho,{...e},e.thumbnail&&t.createElement(at,{thumbnail:e.thumbnail}),t.createElement(V.SelectItemText,null,t.createElement(W,{label:e.label})),t.createElement(V.SelectItemIndicator,null)),Ce=f("div",{position:"absolute !important",zIndex:"1",top:"1rem",left:"1rem",width:"161.8px",height:"100px",backgroundColor:"#000D",boxShadow:"5px 5px 5px #0002",borderRadius:"3px",".displayregion":{border:" 3px solid $accent !important",boxShadow:"0 0 3px #0006"},"@sm":{width:"123px",height:"76px"},"@xs":{width:"100px",height:"61.8px"}}),vo=f("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),Eo=f("div",{width:"100%",height:"100%",maxHeight:"100vh",background:"transparent",backgroundSize:"contain",color:"white",position:"relative",zIndex:"0",overflow:"hidden",variants:{hasNavigator:{true:{[`${Ce}`]:{display:"block"}},false:{[`${Ce}`]:{display:"none"}}}}}),J=({className:e,id:n,label:r,children:i})=>{const o=r.toLowerCase().replace(/\s/g,"-");return t.createElement(ut,{id:n,className:e,"data-testid":"openseadragon-button","data-button":o},t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":`${n}-svg-title`,"data-testid":"openseadragon-button-svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},t.createElement("title",{id:`${n}-svg-title`},r),i))},yo=f("div",{position:"absolute",zIndex:"1",top:"1rem",right:"1rem",display:"flex","@xs":{flexDirection:"column",zIndex:"2"},variants:{hasPlaceholder:{true:{right:"3.618rem","@xs":{top:"3.618rem",right:"1rem"}},false:{right:"1rem","@xs":{top:"1rem",right:"1rem"}}}}}),bo=()=>t.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M256 112v288M400 256H112"}),xo=()=>t.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 256H112"}),wo=()=>t.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M432 320v112H320M421.8 421.77L304 304M80 192V80h112M90.2 90.23L208 208M320 80h112v112M421.77 90.2L304 208M192 432H80V320M90.23 421.8L208 304"}),So=()=>t.createElement("path",{d:"M448 440a16 16 0 01-12.61-6.15c-22.86-29.27-44.07-51.86-73.32-67C335 352.88 301 345.59 256 344.23V424a16 16 0 01-27 11.57l-176-168a16 16 0 010-23.14l176-168A16 16 0 01256 88v80.36c74.14 3.41 129.38 30.91 164.35 81.87C449.32 292.44 464 350.9 464 424a16 16 0 01-16 16z"}),gt=()=>t.createElement(t.Fragment,null,t.createElement("path",{fill:"none",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 148l-21.12-24.57A191.43 191.43 0 00240 64C134 64 48 150 48 256s86 192 192 192a192.09 192.09 0 00181.07-128"}),t.createElement("path",{d:"M464 97.42V208a16 16 0 01-16 16H337.42c-14.26 0-21.4-17.23-11.32-27.31L436.69 86.1C446.77 76 464 83.16 464 97.42z"})),Co=({_cloverViewerHasPlaceholder:e,config:n})=>{const r=k(),{activeCanvas:i,configOptions:o,openSeadragonViewer:a,plugins:l,vault:c,activeManifest:s}=r,d=c.get({id:i,type:"Canvas"});function h(){return l.filter(u=>{var y;return(y=u.imageViewer)==null?void 0:y.menu}).map((u,y)=>{var v,m,p,E;const g=(m=(v=u.imageViewer)==null?void 0:v.menu)==null?void 0:m.component;return t.createElement(g,{key:y,...(E=(p=u==null?void 0:u.imageViewer)==null?void 0:p.menu)==null?void 0:E.componentProps,activeManifest:s,canvas:d,viewerConfigOptions:o,openSeadragonViewer:a,useViewerDispatch:z,useViewerState:k})})}return t.createElement(yo,{"data-testid":"clover-iiif-image-openseadragon-controls",hasPlaceholder:e},n.showZoomControl&&t.createElement(t.Fragment,null,t.createElement(J,{id:n.zoomInButton,label:"zoom in"},t.createElement(bo,null)),t.createElement(J,{id:n.zoomOutButton,label:"zoom out"},t.createElement(xo,null))),n.showFullPageControl&&t.createElement(J,{id:n.fullPageButton,label:"full page"},t.createElement(wo,null)),n.showRotationControl&&t.createElement(t.Fragment,null,t.createElement(J,{id:n.rotateRightButton,label:"rotate right"},t.createElement(gt,null)),t.createElement(J,{id:n.rotateLeftButton,label:"rotate left"},t.createElement(gt,null))),n.showHomeControl&&t.createElement(J,{id:n.homeButton,label:"reset"},t.createElement(So,null)),h())},ko=({ariaLabel:e,config:n,uri:r,_cloverViewerHasPlaceholder:i,imageType:o,openSeadragonCallback:a})=>{const[l,c]=t.useState(),[s,d]=t.useState(),h=z(),u=t.useRef(!1);return t.useEffect(()=>(u.current||(u.current=!0,s||d(re(n))),()=>s==null?void 0:s.destroy()),[]),t.useEffect(()=>{s&&a&&a(s)},[s,a]),t.useEffect(()=>{s&&r!==l&&(s==null||s.forceRedraw(),c(r))},[s,l,r]),t.useEffect(()=>{if(l&&s)switch(o){case"simpleImage":s==null||s.addSimpleImage({url:l});break;case"tiledImage":Xt(l).then(y=>{try{if(!y)throw new Error(`No tile source found for ${l}`);s==null||s.addTiledImage({tileSource:y,success:()=>{typeof h=="function"&&h({type:"updateOSDImageLoaded",OSDImageLoaded:!0})}})}catch(g){console.error(g)}});break;default:s==null||s.close(),console.warn(`Unable to render ${l} in OpenSeadragon as type: "${o}"`);break}},[o,l]),t.createElement(Eo,{className:"clover-iiif-image-openseadragon","data-testid":"clover-iiif-image-openseadragon","data-openseadragon-instance":n.id,hasNavigator:n.showNavigator},t.createElement(Co,{_cloverViewerHasPlaceholder:i,config:n}),n.showNavigator&&t.createElement(Ce,{id:n.navigatorId,"data-testid":"clover-iiif-image-openseadragon-navigator"}),t.createElement(vo,{id:n.id,"data-testid":"clover-iiif-image-openseadragon-viewport",role:"img",...e&&{"aria-label":e}}))};function Io(e){return{id:`openseadragon-${e}`,navigatorId:`openseadragon-navigator-${e}`,loadTilesWithAjax:!0,fullPageButton:`fullPage-${e}`,homeButton:`reset-${e}`,rotateLeftButton:`rotateLeft-${e}`,rotateRightButton:`rotateRight-${e}`,zoomInButton:`zoomIn-${e}`,zoomOutButton:`zoomOut-${e}`,showNavigator:!0,showFullPageControl:!0,showHomeControl:!0,showRotationControl:!0,showZoomControl:!0,navigatorBorderColor:"transparent",gestureSettingsMouse:{clickToZoom:!0,dblClickToZoom:!0,pinchToZoom:!0,scrollToZoom:!1}}}const $o=({_cloverViewerHasPlaceholder:e=!1,body:n,instanceId:r,isTiledImage:i=!1,label:o,src:a="",openSeadragonCallback:l,openSeadragonConfig:c={}})=>{const s=r||ne.v4(),d=typeof o=="string"?o:F(o),h={...Io(s),...c},{imageType:u,uri:y}=n?an(n):ln(a,i);return y?t.createElement(ke.ErrorBoundary,{FallbackComponent:We},t.createElement(ko,{_cloverViewerHasPlaceholder:e,ariaLabel:d,config:h,imageType:u,key:s,uri:y,openSeadragonCallback:l})):null},Ao=({isMedia:e,label:n,placeholderCanvas:r,setIsInteractive:i})=>{const{vault:o}=k(),a=le(o,r),l=a?a[0]:void 0,c=n?Y(n):["placeholder image"];return t.createElement(dt,{onClick:()=>i(!0),isMedia:e,className:"clover-viewer-placeholder"},t.createElement("img",{src:(l==null?void 0:l.id)||"",alt:c.join(),height:l==null?void 0:l.height,width:l==null?void 0:l.width}))},To=f("canvas",{position:"absolute",width:"100%",height:"100%",zIndex:"0"}),Mo=t.forwardRef((e,n)=>{const r=t.useRef(null),i=t.useCallback(()=>{var g,v;if((g=n.current)!=null&&g.currentTime&&((v=n.current)==null?void 0:v.currentTime)>0)return;const a=n.current;if(!a)return;const l=new AudioContext,c=l.createMediaElementSource(a),s=l.createAnalyser(),d=r.current;if(!d)return;d.width=a.offsetWidth,d.height=a.offsetHeight;const h=d.getContext("2d");c.connect(s),s.connect(l.destination),s.fftSize=256;const u=s.frequencyBinCount,y=new Uint8Array(u);setInterval(function(){o(s,h,u,y,d.width,d.height)},20)},[n]);t.useEffect(()=>{!n||!n.current||(n.current.onplay=i)},[i,n]);function o(a,l,c,s,d,h){const u=d/c*2.6;let y,g=0;a.getByteFrequencyData(s),l.fillStyle="#000000",l.fillRect(0,0,d,h);for(let v=0;v<c;v++)y=s[v]*2,l.fillStyle="rgba(78, 42, 132, 1)",l.fillRect(g,h-y,u,y),g+=u+6}return t.createElement(To,{ref:r,role:"presentation"})}),Lo=f("div",{position:"relative",backgroundColor:"$primaryAlt",display:"flex",flexGrow:"0",flexShrink:"1",height:"100%",zIndex:"1",video:{backgroundColor:"transparent",objectFit:"contain",width:"100%",height:"100%",position:"relative",zIndex:"1"}}),zo=({resource:e,ignoreCaptionLabels:n})=>{const r=Y(e.label,"en");return Array.isArray(r)&&r.some(o=>n.includes(o))?null:t.createElement("track",{key:e.id,src:e.id,label:Array.isArray(r)?r[0]:r,srcLang:"en","data-testid":"player-track"})},Fo=["application/vnd.apple.mpegurl","vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"],Po=({allSources:e,annotationResources:n,painting:r})=>{const[i,o]=t.useState(0),[a,l]=t.useState(),c=t.useRef(null),s=(r==null?void 0:r.type)==="Sound",d=k(),{activeCanvas:h,configOptions:u,vault:y}=d;return t.useEffect(()=>{if(!r.id||!c.current)return;if(c!=null&&c.current){const m=c.current;m.src=r.id,m.load()}if(r.id.split(".").pop()!=="m3u8"&&r.format&&!Fo.includes(r.format))return;const g={xhrSetup:function(m,p){m.withCredentials=!!u.withCredentials}},v=new P(g);return v.attachMedia(c.current),v.on(P.Events.MEDIA_ATTACHED,function(){v.loadSource(r.id)}),v.on(P.Events.ERROR,function(m,p){if(p.fatal)switch(p.type){case P.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${m} network error encountered, try to recover`),v.startLoad();break;case P.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${m} media error encountered, try to recover`),v.recoverMediaError();break;default:v.destroy();break}}),()=>{if(v&&c.current){const m=c.current;v.detachMedia(),v.destroy(),m.currentTime=0}}},[u.withCredentials,r.id]),t.useEffect(()=>{var E,b,S,$;const g=y.get(h),v=(E=g.accompanyingCanvas)!=null&&E.id?le(y,(b=g.accompanyingCanvas)==null?void 0:b.id):null,m=(S=g.placeholderCanvas)!=null&&S.id?le(y,($=g.placeholderCanvas)==null?void 0:$.id):null;!!(v&&m)?l(i===0?m[0].id:v[0].id):(v&&l(v[0].id),m&&l(m[0].id))},[h,i,y]),t.useEffect(()=>{if(c!=null&&c.current){const g=c.current;return g==null||g.addEventListener("timeupdate",()=>o(g.currentTime)),()=>document.removeEventListener("timeupdate",()=>{})}},[]),t.createElement(Lo,{css:{backgroundColor:u.canvasBackgroundColor,maxHeight:u.canvasHeight,position:"relative"},"data-testid":"player-wrapper",className:"clover-viewer-player-wrapper"},t.createElement("video",{id:"clover-iiif-video",key:r.id,ref:c,controls:!0,height:r.height,width:r.width,crossOrigin:"anonymous",poster:a,style:{maxHeight:u.canvasHeight,position:"relative",zIndex:"1"}},e.map(g=>t.createElement("source",{src:g.id,type:g.format,key:g.id})),(n==null?void 0:n.length)>0&&n.map(g=>{const v=[];return g.items.forEach(m=>{y.get(m.id).body.forEach(E=>{const b=y.get(E.id);v.push(b)})}),v.map(m=>t.createElement(zo,{resource:m,ignoreCaptionLabels:u.ignoreCaptionLabels||[],key:m.id}))}),"Sorry, your browser doesn't support embedded videos."),s&&t.createElement(Mo,{ref:c}))},Vo=()=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":"close-svg-title",focusable:"false",viewBox:"0 0 512 512",role:"img"},t.createElement("title",{id:"close-svg-title"},"close"),t.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),Bo=({isMedia:e})=>t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":"open-svg-title",focusable:"false",viewBox:"0 0 512 512",role:"img"},t.createElement("title",{id:"open-svg-title"},"open"),e?t.createElement("path",{d:"M133 440a35.37 35.37 0 01-17.5-4.67c-12-6.8-19.46-20-19.46-34.33V111c0-14.37 7.46-27.53 19.46-34.33a35.13 35.13 0 0135.77.45l247.85 148.36a36 36 0 010 61l-247.89 148.4A35.5 35.5 0 01133 440z"}):t.createElement(t.Fragment,null,t.createElement("path",{d:"m456.69,421.39l-94.09-94.09c22.65-30.16,34.88-66.86,34.84-104.58,0-96.34-78.38-174.72-174.72-174.72S48,126.38,48,222.72s78.38,174.72,174.72,174.72c37.72.04,74.42-12.19,104.58-34.84l94.09,94.09c10.29,9.2,26.1,8.32,35.3-1.98,8.48-9.49,8.48-23.83,0-33.32Zm-233.97-73.87c-68.89-.08-124.72-55.91-124.8-124.8h0c0-68.93,55.87-124.8,124.8-124.8s124.8,55.87,124.8,124.8-55.87,124.8-124.8,124.8Z"}),t.createElement("path",{d:"m279.5,197.76h-3.35s-28.47,0-28.47,0v-31.82c-.77-13.79-12.57-24.33-26.36-23.56-12.71.71-22.85,10.86-23.56,23.56v3.35h0v28.47h-31.82c-13.79.77-24.33,12.57-23.56,26.36.71,12.71,10.86,22.85,23.56,23.56h3.35s28.47,0,28.47,0v31.82c.77,13.79,12.57,24.33,26.36,23.56,12.71-.71,22.85-10.86,23.56-23.56v-3.35h0v-28.47h31.82c13.79-.77,24.33-12.57,23.56-26.36-.71-12.71-10.86-22.85-23.56-23.56Z"}))),Oo=({handleToggle:e,isInteractive:n,isMedia:r})=>t.createElement(mt,{onClick:e,isInteractive:n,isMedia:r,"data-testid":"placeholder-toggle"},n?t.createElement(Vo,null):t.createElement(Bo,{isMedia:r})),Ho=({activeCanvas:e,annotationResources:n,isMedia:r,painting:i})=>{var A,_,D,q,ee;const[o,a]=t.useState(0),[l,c]=t.useState(!1),{configOptions:s,customDisplays:d,openSeadragonViewer:h,vault:u,viewerId:y}=k(),g=z(),v=u.get(e),m=(A=v==null?void 0:v.placeholderCanvas)==null?void 0:A.id,p=!!m,E=(i==null?void 0:i.length)>1,b=m&&!l&&!r,S=`${y}-${_t(e+o)}`,$=()=>c(!l),L=x=>{const M=i.findIndex(j=>j.id===x);a(M)},I=d.find(x=>{var $t;let M=!1;const{canvasId:j,paintingFormat:te}=x.target;if(Array.isArray(j)&&j.length>0&&(M=j.includes(e)),Array.isArray(te)&&te.length>0){const At=(($t=i[o])==null?void 0:$t.format)||"";M=!!(At&&te.includes(At))}return M}),O=[];(D=(_=n[0])==null?void 0:_.items)==null||D.forEach(x=>{const M=u.get(x.id);O.push(M)}),t.useEffect(()=>{var x;O&&h&&((x=s.annotationOverlays)!=null&&x.renderOverlays)&&(Ne(h,"annotation-overlay"),He(h,v,s.annotationOverlays,O,"annotation-overlay"))},[v,O,h,s]);const H=x=>{x&&(h==null?void 0:h.id)!==`openseadragon-${S}`&&g({type:"updateOpenSeadragonViewer",openSeadragonViewer:x})},w=(q=I==null?void 0:I.display)==null?void 0:q.component;return t.createElement(co,{className:"clover-viewer-painting"},t.createElement(uo,{style:{backgroundColor:s.canvasBackgroundColor,height:"100%"}},m&&!r&&t.createElement(Oo,{handleToggle:$,isInteractive:l,isMedia:r}),b&&!r&&t.createElement(Ao,{isMedia:r,label:v==null?void 0:v.label,placeholderCanvas:m,setIsInteractive:c}),!b&&!I&&(r?t.createElement(Po,{allSources:i,painting:i[o],annotationResources:n}):i&&t.createElement($o,{_cloverViewerHasPlaceholder:p,body:i[o],instanceId:S,key:S,openSeadragonCallback:H,openSeadragonConfig:s.openSeadragon})),!b&&w&&t.createElement(w,{id:e,annotationBody:i[o],...I==null?void 0:I.display.componentProps})),E&&t.createElement(ft,{value:(ee=i[o])==null?void 0:ee.id,onValueChange:L,maxHeight:"200px"},i==null?void 0:i.map(x=>t.createElement(ht,{value:x==null?void 0:x.id,key:x==null?void 0:x.id,label:x==null?void 0:x.label}))))},_o=({activeCanvas:e,annotationResources:n,searchServiceUrl:r,setContentSearchResource:i,contentSearchResource:o,isAudioVideo:a,items:l,painting:c})=>{const{isInformationOpen:s,configOptions:d}=k(),{informationPanel:h}=d,u=(h==null?void 0:h.renderAbout)&&s,y=(h==null?void 0:h.renderAnnotation)&&n.length>0&&!h.open||o;return t.createElement(je,{className:"clover-viewer-content",style:{height:d.canvasHeight??"100%"},"data-testid":"clover-viewer-content"},t.createElement(Ge,null,t.createElement(Ho,{activeCanvas:e,annotationResources:n,isMedia:a,painting:c}),u&&t.createElement(Ue,null,t.createElement("span",null,s?"View Items":"More Information")),l.length>1&&s&&t.createElement(qe,{className:"clover-viewer-media-wrapper"},t.createElement(so,{items:l,activeItem:0}))),(u||y)&&s&&t.createElement(pn,null,t.createElement(Ze,null,t.createElement(Mr,{activeCanvas:e,annotationResources:n,searchServiceUrl:r,setContentSearchResource:i,contentSearchResource:o}))))},Do=f(Z.Trigger,{width:"30px",padding:"5px"}),vt=f(Z.Content,{display:"flex",flexDirection:"column",fontSize:"0.8333rem",border:"none",boxShadow:"2px 2px 5px #0003",zIndex:"2",button:{display:"flex",textDecoration:"none",marginBottom:"0.5em",color:"$accentAlt",cursor:"pointer",background:"$secondary",border:"none","&:last-child":{marginBottom:"0"}}}),No=f("span",{fontSize:"1.33rem",alignSelf:"flex-start",flexGrow:"0",flexShrink:"1",padding:"1rem","@sm":{fontSize:"1rem"},"&.visually-hidden":{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:"0"}}),Wo=f("header",{display:"flex",backgroundColor:"transparent !important",justifyContent:"space-between",alignItems:"flex-start",width:"100%",[`> ${pt}`]:{flexGrow:"1",flexShrink:"0"},form:{flexGrow:"0",flexShrink:"1"}}),qo=f("div",{display:"flex",alignItems:"flex-end",justifyContent:"flex-end",padding:"1rem",flexShrink:"0",flexGrow:"1"}),jo=()=>{var s;const e=z(),n=k(),{activeManifest:r,collection:i,configOptions:o,vault:a}=n,l=o==null?void 0:o.canvasHeight,c=d=>{e({type:"updateActiveManifest",manifestId:d}),e({type:"updateViewerId",viewerId:ne.v4()})};return t.createElement("div",{style:{margin:"0.75rem"}},t.createElement(ft,{label:i.label,maxHeight:l,value:r,onValueChange:c},(s=i==null?void 0:i.items)==null?void 0:s.map(d=>t.createElement(ht,{value:d.id,key:d.id,thumbnail:d!=null&&d.thumbnail?a.get(d==null?void 0:d.thumbnail):void 0,label:d.label}))))},Go=(e,n=2500)=>{const[r,i]=t.useState(),o=t.useCallback(()=>{navigator.clipboard.writeText(e).then(()=>i("copied"),()=>i("failed"))},[e]);return t.useEffect(()=>{if(!r)return;const a=setTimeout(()=>i(void 0),n);return()=>clearTimeout(a)},[r]),[r,o]},Uo=f("span",{display:"flex",alignContent:"center",alignItems:"center",padding:"0.125rem 0.25rem 0",marginTop:"-0.125rem",marginLeft:"0.5rem",backgroundColor:"$accent",color:"$secondary",borderRadius:"3px",fontSize:"0.6111rem",textTransform:"uppercase",lineHeight:"1em"}),Zo=({status:e})=>e?t.createElement(Uo,{"data-copy-status":e},e):null,Et=({textPrompt:e,textToCopy:n})=>{const[r,i]=Go(n);return t.createElement("button",{onClick:i},e," ",t.createElement(Zo,{status:r}))},Xo=()=>{const e="#ed1d33",n="#2873ab";return t.createElement("svg",{viewBox:"0 0 493.35999 441.33334",id:"iiif-logo",version:"1.1"},t.createElement("title",null,"IIIF Manifest Options"),t.createElement("g",{transform:"matrix(1.3333333,0,0,-1.3333333,0,441.33333)"},t.createElement("g",{transform:"scale(0.1)"},t.createElement("path",{style:{fill:n},d:"M 65.2422,2178.75 775.242,1915 773.992,15 65.2422,276.25 v 1902.5"}),t.createElement("path",{style:{fill:n},d:"m 804.145,2640.09 c 81.441,-240.91 -26.473,-436.2 -241.04,-436.2 -214.558,0 -454.511,195.29 -535.9527,436.2 -81.4335,240.89 26.4805,436.18 241.0387,436.18 214.567,0 454.512,-195.29 535.954,-436.18"}),t.createElement("path",{style:{fill:e},d:"M 1678.58,2178.75 968.578,1915 969.828,15 1678.58,276.25 v 1902.5"}),t.createElement("path",{style:{fill:e},d:"m 935.082,2640.09 c -81.437,-240.91 26.477,-436.2 241.038,-436.2 214.56,0 454.51,195.29 535.96,436.2 81.43,240.89 -26.48,436.18 -241.04,436.18 -214.57,0 -454.52,-195.29 -535.958,-436.18"}),t.createElement("path",{style:{fill:n},d:"m 1860.24,2178.75 710,-263.75 -1.25,-1900 -708.75,261.25 v 1902.5"}),t.createElement("path",{style:{fill:n},d:"m 2603.74,2640.09 c 81.45,-240.91 -26.47,-436.2 -241.03,-436.2 -214.58,0 -454.52,195.29 -535.96,436.2 -81.44,240.89 26.48,436.18 241.03,436.18 214.57,0 454.51,-195.29 535.96,-436.18"}),t.createElement("path",{style:{fill:e},d:"m 3700.24,3310 v -652.5 c 0,0 -230,90 -257.5,-142.5 -2.5,-247.5 0,-336.25 0,-336.25 l 257.5,83.75 V 1690 l -258.61,-92.5 V 262.5 L 2735.24,0 v 2360 c 0,0 -15,850 965,950"}))))},Yo=f($e.Root,{all:"unset",height:"2rem",width:"3.236rem",backgroundColor:"#6663",borderRadius:"9999px",position:"relative",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:focus":{boxShadow:"0 0 0 2px $secondaryAlt"},'&[data-state="checked"]':{backgroundColor:"$accent",boxShadow:"inset 2px 2px 5px #0003"}}),Jo=f($e.Thumb,{display:"block",height:"calc(2rem - 12px)",width:"calc(2rem - 12px)",backgroundColor:"$secondary",borderRadius:"100%",boxShadow:"2px 2px 5px #0001",transition:"$all",transform:"translateX(6px)",willChange:"transform",'&[data-state="checked"]':{transform:"translateX(calc(1.236rem + 6px))"}}),Ko=f("label",{fontSize:"0.8333rem",fontWeight:"400",lineHeight:"1em",userSelect:"none",cursor:"pointer",paddingRight:"0.618rem"}),Qo=f("form",{display:"flex",flexShrink:"0",flexGrow:"1",alignItems:"center",marginLeft:"1.618rem"}),Ro=()=>{var a,l;const{configOptions:e}=k(),n=z(),[r,i]=t.useState((a=e==null?void 0:e.informationPanel)==null?void 0:a.open),o=((l=e==null?void 0:e.informationPanel)==null?void 0:l.toggleLabel)??"More information";return t.useEffect(()=>{n({type:"updateInformationOpen",isInformationOpen:r})},[r,n]),t.createElement(Qo,null,t.createElement(Ko,{htmlFor:"information-toggle",css:r?{opacity:"1"}:{}},o),t.createElement(Yo,{checked:r,onCheckedChange:()=>i(!r),id:"information-toggle","aria-label":"information panel toggle",name:"toggled?"},t.createElement(Jo,null)))},ei=f(Z.Trigger,{width:"30px",padding:"5px"}),ti=f(vt,{h3:{color:"$primaryAlt",fontSize:"$2",fontWeight:"700",margin:"$2 0"},button:{},"& ul li":{marginBottom:"$1"}});function ni(e){const{vault:n}=k();try{const r=e&&n.get(e);if(!r)throw new Error(`Vault entity ${e} not found.`);return(r==null?void 0:r["@id"])||(r==null?void 0:r.id)}catch(r){return console.error(r),e}}function yt(e,n){const r=[];if(!e)return r;for(const i of e)if(i.id){const o=n.get(i.id);o&&r.push(o)}return r}function ri(){const{activeCanvas:e,activeManifest:n,vault:r}=k(),[i,o]=t.useState({root:[],canvas:[]});return t.useEffect(()=>{const a=r.get(n),l=r.get(e),c=a==null?void 0:a.rendering,s=l==null?void 0:l.rendering,d=yt(c,r),h=yt(s,r);o({root:d,canvas:h})},[e,n,r]),{...i}}function bt(e,n){return e.map(({format:r,id:i,label:o})=>{const a=ni(i);return{format:r,id:a,label:F(o)||n}})}function oi(){const e=ri(),n=bt((e==null?void 0:e.root)||[],"Root Rendering Label"),r=bt((e==null?void 0:e.canvas)||[],"Canvas Rendering Label");return{allPages:n,individualPages:r}}const ii=()=>{const{allPages:e,individualPages:n}=oi(),r=e.length>0||n.length>0,i=o=>{window.open(o,"_blank")};return r?t.createElement(Z,null,t.createElement(ei,{"data-testid":"download-button"},t.createElement(T,null,t.createElement(T.Download,null))),t.createElement(ti,{"data-testid":"download-content"},n.length>0&&t.createElement(t.Fragment,null,t.createElement("h3",null,"Individual Pages"),t.createElement("ul",null,n.map(({format:o,id:a,label:l})=>t.createElement("li",{key:l},t.createElement("button",{onClick:()=>i(a)},l," (",o,")"))))),e.length>0&&t.createElement(t.Fragment,null,t.createElement("h3",null,"All Pages"),t.createElement("ul",null,e.map(({format:o,id:a,label:l})=>t.createElement("li",{key:l},t.createElement("button",{onClick:()=>i(a)},l," (",o,")"))))))):null},xt=e=>{const n=()=>window.matchMedia?window.matchMedia(e).matches:!1,[r,i]=t.useState(n);return t.useEffect(()=>{const o=()=>i(n);return window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)}),r},ai=({manifestId:e,manifestLabel:n})=>{const r=k(),{collection:i,configOptions:o}=r,{informationPanel:a,showDownload:l,showIIIFBadge:c,showTitle:s}=o,d=l||c||(a==null?void 0:a.renderToggle),h=xt(ge.sm);return t.createElement(Wo,{className:"clover-viewer-header"},i!=null&&i.items?t.createElement(jo,null):t.createElement(No,{className:s?"":"visually-hidden"},s&&t.createElement(W,{label:n,className:"label"})),d&&t.createElement(qo,null,l&&t.createElement(ii,null),c&&t.createElement(Z,null,t.createElement(Do,null,t.createElement(Xo,null)),t.createElement(vt,null,(i==null?void 0:i.items)&&t.createElement("button",{onClick:u=>{u.preventDefault(),window.open(i.id,"_blank")}},"View Collection"),t.createElement("button",{onClick:u=>{u.preventDefault(),window.open(e,"_blank")}},"View Manifest")," ",(i==null?void 0:i.items)&&t.createElement(Et,{textPrompt:"Copy Collection URL",textToCopy:i.id}),t.createElement(Et,{textPrompt:"Copy Manifest URL",textToCopy:e}))),(a==null?void 0:a.renderToggle)&&!h&&t.createElement(Ro,null)))},li=(e=!1)=>{const[n,r]=t.useState(e);return t.useLayoutEffect(()=>{if(!n)return;const i=document.documentElement.style.overflow;return document.documentElement.style.overflow="hidden",()=>{document.documentElement.style.overflow=i}},[n]),t.useEffect(()=>{n!==e&&r(e)},[e]),[n,r]},si=({manifest:e,theme:n,iiifContentSearchQuery:r})=>{var ee;const i=k(),o=z(),{activeCanvas:a,isInformationOpen:l,vault:c,contentSearchVault:s,configOptions:d,openSeadragonViewer:h}=i,u=["100%","auto"],y=(d==null?void 0:d.canvasHeight)&&u.includes(d==null?void 0:d.canvasHeight),[g,v]=t.useState(!1),[m,p]=t.useState(!1),[E,b]=t.useState([]),[S,$]=t.useState([]),[L,I]=t.useState(),[O,H]=li(!1),w=xt(ge.sm),[A,_]=t.useState(),D=t.useCallback(x=>{o({type:"updateInformationOpen",isInformationOpen:x})},[o]);t.useEffect(()=>{var x;(x=d==null?void 0:d.informationPanel)!=null&&x.open&&D(!w)},[w,(ee=d==null?void 0:d.informationPanel)==null?void 0:ee.open,D]),t.useEffect(()=>{if(!w){H(!1);return}H(l)},[l,w,H]),t.useEffect(()=>{const x=le(c,a);x&&(p(["Sound","Video"].indexOf(x[0].type)>-1),b(x));const M=Gt(c,a);M.length>0&&o({type:"updateInformationOpen",isInformationOpen:!0}),$(M),v(M.length!==0)},[a,c,o]);const q=e.service.some(x=>x.type==="SearchService2");return t.useEffect(()=>{if(q){const x=e.service.find(M=>M.type==="SearchService2");x&&_(x.id)}},[e,q]),t.useEffect(()=>{var x,M,j;A&&((x=d.informationPanel)==null?void 0:x.renderContentSearch)!==!1&&Pe(s,A,(j=(M=d.localeText)==null?void 0:M.contentSearch)==null?void 0:j.tabLabel,r).then(te=>{I(te)})},[A]),t.useEffect(()=>{if(!h||!L)return;const x=c.get({id:a,type:"Canvas"});Ne(h,"content-search-overlay"),sn(s,L,h,x,d)},[h,L]),t.createElement(ke.ErrorBoundary,{FallbackComponent:We},t.createElement(fn,{className:`${n} clover-viewer`,css:{background:d==null?void 0:d.background},"data-body-locked":O,"data-absolute-position":y,"data-information-panel":g,"data-information-panel-open":l},t.createElement(ue.Root,{open:l,onOpenChange:D},t.createElement(ai,{manifestLabel:e.label,manifestId:e.id}),t.createElement(_o,{activeCanvas:a,painting:E,annotationResources:S,searchServiceUrl:A,setContentSearchResource:I,contentSearchResource:L,items:e.items,isAudioVideo:m}))))},wt={ignoreCache:!1,headers:{Accept:"application/json, text/javascript, text/plain"},timeout:5e3,withCredentials:!1};function ci(e){return{ok:e.status>=200&&e.status<300,status:e.status,statusText:e.statusText,headers:e.getAllResponseHeaders(),data:e.responseText,json:()=>JSON.parse(e.responseText)}}function St(e,n=null){return{ok:!1,status:e.status,statusText:e.statusText,headers:e.getAllResponseHeaders(),data:n||e.statusText,json:()=>JSON.parse(n||e.statusText)}}function di(e,n=wt){const r=n.headers||wt.headers;return new Promise((i,o)=>{const a=new XMLHttpRequest;a.open("get",e),a.withCredentials=n.withCredentials,r&&Object.keys(r).forEach(l=>a.setRequestHeader(l,r[l])),a.onload=()=>{i(ci(a))},a.onerror=()=>{o(St(a,"Failed to make request."))},a.ontimeout=()=>{o(St(a,"Request took longer than expected."))},a.send()})}const ui=({canvasIdCallback:e=()=>{},customDisplays:n=[],plugins:r=[],customTheme:i,iiifContent:o,id:a,manifestId:l,options:c,iiifContentSearchQuery:s})=>{var u,y,g;let d=o;a&&(d=a),l&&(d=l);const h=Le((y=(u=c==null?void 0:c.informationPanel)==null?void 0:u.vtt)==null?void 0:y.autoScroll);return t.createElement(jt,{initialState:{...ae,customDisplays:n,plugins:r,isAutoScrollEnabled:h.enabled,isInformationOpen:!!((g=c==null?void 0:c.informationPanel)!=null&&g.open),vault:new de.Vault({customFetcher:v=>di(v,{withCredentials:c==null?void 0:c.withCredentials,headers:c==null?void 0:c.requestHeaders}).then(m=>JSON.parse(m.data))})}},t.createElement(mi,{iiifContent:d,canvasIdCallback:e,customTheme:i,options:c,iiifContentSearchQuery:s}))},mi=({canvasIdCallback:e,customTheme:n,iiifContent:r,options:i,iiifContentSearchQuery:o})=>{const a=z(),l=k(),{activeCanvas:c,activeManifest:s,isLoaded:d,vault:h}=l,[u,y]=t.useState(),[g,v]=t.useState();let m={};return n&&(m=Ie.createTheme("custom",n)),t.useEffect(()=>{e&&e(c)},[c,e]),t.useEffect(()=>{s&&h.loadManifest(s).then(p=>{v(p),a({type:"updateActiveCanvas",canvasId:Kt(r,p)})}).catch(p=>{console.error(`Manifest failed to load: ${p}`)}).finally(()=>{a({type:"updateIsLoaded",isLoaded:!0})})},[r,s,a,h]),t.useEffect(()=>{a({type:"updateConfigOptions",configOptions:i});const p=Jt(r);h.load(p).then(E=>{y(E)}).catch(E=>{console.error(`The IIIF resource ${r} failed to load: ${E}`)})},[a,r,i,h]),t.useEffect(()=>{if((u==null?void 0:u.type)==="Collection"){a({type:"updateCollection",collection:u});const p=Qt(r,u);p&&a({type:"updateActiveManifest",manifestId:p})}else(u==null?void 0:u.type)==="Manifest"&&a({type:"updateActiveManifest",manifestId:u.id})},[a,r,u]),d?!g||!g.items?(console.log(`The IIIF manifest ${r} failed to load.`),t.createElement(t.Fragment,null)):g.items.length===0?(console.log(`The IIIF manifest ${r} does not contain canvases.`),t.createElement(t.Fragment,null)):t.createElement(si,{manifest:g,theme:m,key:g.id,iiifContentSearchQuery:o}):t.createElement(t.Fragment,null,"Loading")};C.default=ui,Object.defineProperties(C,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=index.umd.js.map
